function cov_25c10qnwnj(){var path="G:\\SWbackend\\Integrated\\Backend-team\\Services\\deleteTrackFromPlaylist.js";var hash="5423848a2153b74cf3f4a4939dfdc9a9065aba5a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"G:\\SWbackend\\Integrated\\Backend-team\\Services\\deleteTrackFromPlaylist.js",statementMap:{"0":{start:{line:2,column:15},end:{line:2,column:33}},"1":{start:{line:3,column:17},end:{line:3,column:35}},"2":{start:{line:4,column:16},end:{line:4,column:38}},"3":{start:{line:6,column:15},end:{line:6,column:45}},"4":{start:{line:7,column:11},end:{line:7,column:42}},"5":{start:{line:8,column:11},end:{line:8,column:42}},"6":{start:{line:9,column:15},end:{line:9,column:50}},"7":{start:{line:12,column:8},end:{line:12,column:17}},"8":{start:{line:14,column:0},end:{line:14,column:27}},"9":{start:{line:16,column:0},end:{line:72,column:3}},"10":{start:{line:17,column:16},end:{line:17,column:36}},"11":{start:{line:18,column:4},end:{line:71,column:6}},"12":{start:{line:19,column:8},end:{line:21,column:9}},"13":{start:{line:20,column:12},end:{line:20,column:36}},"14":{start:{line:22,column:16},end:{line:22,column:24}},"15":{start:{line:23,column:4},end:{line:25,column:5}},"16":{start:{line:24,column:8},end:{line:24,column:98}},"17":{start:{line:26,column:4},end:{line:28,column:5}},"18":{start:{line:27,column:8},end:{line:27,column:81}},"19":{start:{line:29,column:17},end:{line:29,column:33}},"20":{start:{line:30,column:4},end:{line:32,column:5}},"21":{start:{line:31,column:8},end:{line:31,column:56}},"22":{start:{line:34,column:21},end:{line:34,column:42}},"23":{start:{line:35,column:4},end:{line:68,column:6}},"24":{start:{line:36,column:8},end:{line:39,column:9}},"25":{start:{line:38,column:12},end:{line:38,column:62}},"26":{start:{line:41,column:8},end:{line:64,column:11}},"27":{start:{line:42,column:12},end:{line:62,column:13}},"28":{start:{line:43,column:16},end:{line:43,column:76}},"29":{start:{line:46,column:31},end:{line:46,column:47}},"30":{start:{line:47,column:16},end:{line:55,column:17}},"31":{start:{line:47,column:30},end:{line:47,column:31}},"32":{start:{line:48,column:20},end:{line:54,column:21}},"33":{start:{line:49,column:38},end:{line:49,column:54}},"34":{start:{line:50,column:24},end:{line:52,column:25}},"35":{start:{line:50,column:40},end:{line:50,column:45}},"36":{start:{line:51,column:28},end:{line:51,column:65}},"37":{start:{line:53,column:23},end:{line:53,column:39}},"38":{start:{line:56,column:16},end:{line:59,column:19}},"39":{start:{line:60,column:16},end:{line:60,column:84}},"40":{start:{line:67,column:8},end:{line:67,column:77}},"41":{start:{line:70,column:8},end:{line:70,column:52}},"42":{start:{line:84,column:0},end:{line:88,column:1}},"43":{start:{line:85,column:4},end:{line:87,column:7}},"44":{start:{line:86,column:8},end:{line:86,column:44}},"45":{start:{line:89,column:0},end:{line:89,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:31},end:{line:16,column:32}},loc:{start:{line:16,column:42},end:{line:72,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:33},end:{line:18,column:34}},loc:{start:{line:18,column:41},end:{line:69,column:5}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:35,column:82},end:{line:35,column:83}},loc:{start:{line:35,column:97},end:{line:66,column:5}},line:35},"3":{name:"(anonymous_3)",decl:{start:{line:41,column:92},end:{line:41,column:93}},loc:{start:{line:41,column:105},end:{line:64,column:9}},line:41},"4":{name:"(anonymous_4)",decl:{start:{line:56,column:135},end:{line:56,column:136}},loc:{start:{line:56,column:142},end:{line:59,column:17}},line:56},"5":{name:"(anonymous_5)",decl:{start:{line:66,column:13},end:{line:66,column:14}},loc:{start:{line:66,column:18},end:{line:68,column:5}},line:66},"6":{name:"(anonymous_6)",decl:{start:{line:69,column:13},end:{line:69,column:14}},loc:{start:{line:69,column:18},end:{line:71,column:5}},line:69},"7":{name:"(anonymous_7)",decl:{start:{line:85,column:20},end:{line:85,column:21}},loc:{start:{line:85,column:24},end:{line:87,column:5}},line:85}},branchMap:{"0":{loc:{start:{line:19,column:8},end:{line:21,column:9}},type:"if",locations:[{start:{line:19,column:8},end:{line:21,column:9}},{start:{line:19,column:8},end:{line:21,column:9}}],line:19},"1":{loc:{start:{line:23,column:4},end:{line:25,column:5}},type:"if",locations:[{start:{line:23,column:4},end:{line:25,column:5}},{start:{line:23,column:4},end:{line:25,column:5}}],line:23},"2":{loc:{start:{line:26,column:4},end:{line:28,column:5}},type:"if",locations:[{start:{line:26,column:4},end:{line:28,column:5}},{start:{line:26,column:4},end:{line:28,column:5}}],line:26},"3":{loc:{start:{line:30,column:4},end:{line:32,column:5}},type:"if",locations:[{start:{line:30,column:4},end:{line:32,column:5}},{start:{line:30,column:4},end:{line:32,column:5}}],line:30},"4":{loc:{start:{line:36,column:8},end:{line:39,column:9}},type:"if",locations:[{start:{line:36,column:8},end:{line:39,column:9}},{start:{line:36,column:8},end:{line:39,column:9}}],line:36},"5":{loc:{start:{line:42,column:12},end:{line:62,column:13}},type:"if",locations:[{start:{line:42,column:12},end:{line:62,column:13}},{start:{line:42,column:12},end:{line:62,column:13}}],line:42},"6":{loc:{start:{line:48,column:20},end:{line:54,column:21}},type:"if",locations:[{start:{line:48,column:20},end:{line:54,column:21}},{start:{line:48,column:20},end:{line:54,column:21}}],line:48},"7":{loc:{start:{line:84,column:0},end:{line:88,column:1}},type:"if",locations:[{start:{line:84,column:0},end:{line:88,column:1}},{start:{line:84,column:0},end:{line:88,column:1}}],line:84}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5423848a2153b74cf3f4a4939dfdc9a9065aba5a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_25c10qnwnj=function(){return actualCoverage;};return actualCoverage;}cov_25c10qnwnj();//library imports
const express=(cov_25c10qnwnj().s[0]++,require('express'));const{ObjectID}=(cov_25c10qnwnj().s[1]++,require("mongodb"));// if the id is autogenerated we have to use the ObjectID as it is not a string it is an objectid
var bodyParser=(cov_25c10qnwnj().s[2]++,require('body-parser'));var{mongoose}=(cov_25c10qnwnj().s[3]++,require("./../db/mongoose.js"));var{track}=(cov_25c10qnwnj().s[4]++,require("./../models/track.js"));var{User}=(cov_25c10qnwnj().s[5]++,require("./../models/users.js"));// users model
var{playlist}=(cov_25c10qnwnj().s[6]++,require("./../models/playlists.js"));// playlists model
var app=(cov_25c10qnwnj().s[7]++,express());//configures the middlewear
cov_25c10qnwnj().s[8]++;app.use(bodyParser.json());cov_25c10qnwnj().s[9]++;app.delete('/playlists/tracks',(req,res)=>{cov_25c10qnwnj().f[0]++;var token=(cov_25c10qnwnj().s[10]++,req.header('x-auth'));cov_25c10qnwnj().s[11]++;User.findByToken(token).then(user=>{cov_25c10qnwnj().f[1]++;cov_25c10qnwnj().s[12]++;if(!user){cov_25c10qnwnj().b[0][0]++;cov_25c10qnwnj().s[13]++;return Promise.reject();}else{cov_25c10qnwnj().b[0][1]++;}var userId2=(cov_25c10qnwnj().s[14]++,user._id);// id of the owner of the playlist 
cov_25c10qnwnj().s[15]++;if(!req.body.playlistName){cov_25c10qnwnj().b[1][0]++;cov_25c10qnwnj().s[16]++;return res.status(400).send("Pass the playlistname that you want to delete a track from");}else{cov_25c10qnwnj().b[1][1]++;}cov_25c10qnwnj().s[17]++;if(!req.body.trackId){cov_25c10qnwnj().b[2][0]++;cov_25c10qnwnj().s[18]++;return res.status(400).send("Pass the track id that you want to delete");}else{cov_25c10qnwnj().b[2][1]++;}var trackId=(cov_25c10qnwnj().s[19]++,req.body.trackId);cov_25c10qnwnj().s[20]++;if(!ObjectID.isValid(trackId)){cov_25c10qnwnj().b[3][0]++;cov_25c10qnwnj().s[21]++;return res.status(404).send("Invalid Track Id");}else{cov_25c10qnwnj().b[3][1]++;}var playlistName=(cov_25c10qnwnj().s[22]++,req.body.playlistName);cov_25c10qnwnj().s[23]++;playlist.findOne({$and:[{userId:userId2},{playlistName:playlistName}]}).then(delPlaylist=>{cov_25c10qnwnj().f[2]++;cov_25c10qnwnj().s[24]++;if(!delPlaylist){cov_25c10qnwnj().b[4][0]++;cov_25c10qnwnj().s[25]++;return res.status(404).send('Playlist not found');}else{cov_25c10qnwnj().b[4][1]++;}cov_25c10qnwnj().s[26]++;playlist.findOne({$and:[{tracks:{$eq:trackId}},{playlistName:playlistName}]}).then(delTrack1=>{cov_25c10qnwnj().f[3]++;cov_25c10qnwnj().s[27]++;if(!delTrack1){cov_25c10qnwnj().b[5][0]++;cov_25c10qnwnj().s[28]++;return res.status(400).send("Track is not in the playlist");}else{cov_25c10qnwnj().b[5][1]++;var tracksarr=(cov_25c10qnwnj().s[29]++,delTrack1.tracks);cov_25c10qnwnj().s[30]++;for(var count=(cov_25c10qnwnj().s[31]++,0);count<tracksarr.length;count++){cov_25c10qnwnj().s[32]++;if(tracksarr[count]==trackId){cov_25c10qnwnj().b[6][0]++;var temptrack=(cov_25c10qnwnj().s[33]++,tracksarr[count]);cov_25c10qnwnj().s[34]++;for(var count2=(cov_25c10qnwnj().s[35]++,count);count2<tracksarr.length-1;count2++){cov_25c10qnwnj().s[36]++;tracksarr[count2]=tracksarr[count2+1];}cov_25c10qnwnj().s[37]++;tracksarr.pop();}else{cov_25c10qnwnj().b[6][1]++;}}cov_25c10qnwnj().s[38]++;playlist.findOneAndUpdate({$and:[{userId:userId2},{playlistName:playlistName}]},{$set:{tracks:tracksarr}}).then(res=>{cov_25c10qnwnj().f[4]++;});cov_25c10qnwnj().s[39]++;res.status(200).send("Track is successfully deleted from playlist");}});}).catch(e=>{cov_25c10qnwnj().f[5]++;cov_25c10qnwnj().s[40]++;res.status(500).send("Could not remove the track from the playlist");});}).catch(e=>{cov_25c10qnwnj().f[6]++;cov_25c10qnwnj().s[41]++;res.status(401).send('Unauthorized Access');});});cov_25c10qnwnj().s[42]++;if(!module.parent){cov_25c10qnwnj().b[7][0]++;cov_25c10qnwnj().s[43]++;app.listen(3000,()=>{cov_25c10qnwnj().f[7]++;cov_25c10qnwnj().s[44]++;console.log("Started on port 3000");});}else{cov_25c10qnwnj().b[7][1]++;}cov_25c10qnwnj().s[45]++;module.exports={app};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlbGV0ZVRyYWNrRnJvbVBsYXlsaXN0LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiT2JqZWN0SUQiLCJib2R5UGFyc2VyIiwibW9uZ29vc2UiLCJ0cmFjayIsIlVzZXIiLCJwbGF5bGlzdCIsImFwcCIsInVzZSIsImpzb24iLCJkZWxldGUiLCJyZXEiLCJyZXMiLCJ0b2tlbiIsImhlYWRlciIsImZpbmRCeVRva2VuIiwidGhlbiIsInVzZXIiLCJQcm9taXNlIiwicmVqZWN0IiwidXNlcklkMiIsIl9pZCIsImJvZHkiLCJwbGF5bGlzdE5hbWUiLCJzdGF0dXMiLCJzZW5kIiwidHJhY2tJZCIsImlzVmFsaWQiLCJmaW5kT25lIiwiJGFuZCIsInVzZXJJZCIsImRlbFBsYXlsaXN0IiwidHJhY2tzIiwiJGVxIiwiZGVsVHJhY2sxIiwidHJhY2tzYXJyIiwiY291bnQiLCJsZW5ndGgiLCJ0ZW1wdHJhY2siLCJjb3VudDIiLCJwb3AiLCJmaW5kT25lQW5kVXBkYXRlIiwiJHNldCIsImNhdGNoIiwiZSIsIm1vZHVsZSIsInBhcmVudCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoic3pNQUFBO0FBQ0EsS0FBTUEsQ0FBQUEsT0FBTywwQkFBRUMsT0FBTyxDQUFDLFNBQUQsQ0FBVCxDQUFiLENBQ0EsS0FBTSxDQUFDQyxRQUFELDJCQUFXRCxPQUFPLENBQUMsU0FBRCxDQUFsQixDQUFOLENBQXNDO0FBQ3RDLEdBQUlFLENBQUFBLFVBQVUsMEJBQUVGLE9BQU8sQ0FBQyxhQUFELENBQVQsQ0FBZCxDQUVBLEdBQUcsQ0FBQ0csUUFBRCwyQkFBWUgsT0FBTyxDQUFDLHFCQUFELENBQW5CLENBQUgsQ0FDQSxHQUFHLENBQUNJLEtBQUQsMkJBQVFKLE9BQU8sQ0FBQyxzQkFBRCxDQUFmLENBQUgsQ0FDQSxHQUFHLENBQUNLLElBQUQsMkJBQVFMLE9BQU8sQ0FBQyxzQkFBRCxDQUFmLENBQUgsQ0FBNEM7QUFDNUMs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RCxFLHlCQW9FQSxHQUFHLENBQUNvQixNQUFNLENBQUNDLE1BQVgsQ0FBa0IscURBQ2R2QyxHQUFHLENBQUN3QyxNQUFKLENBQVcsSUFBWCxDQUFnQixJQUFJLGtEQUNoQkMsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosRUFDSCxDQUZELEVBR0gsQ0FKRCxpQyx5QkFLQUosTUFBTSxDQUFDSyxPQUFQLENBQWUsQ0FBQzNDLEdBQUQsQ0FBZiIsInNvdXJjZXNDb250ZW50IjpbIi8vbGlicmFyeSBpbXBvcnRzXHJcbmNvbnN0IGV4cHJlc3M9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qge09iamVjdElEfT1yZXF1aXJlKFwibW9uZ29kYlwiKTsgIC8vIGlmIHRoZSBpZCBpcyBhdXRvZ2VuZXJhdGVkIHdlIGhhdmUgdG8gdXNlIHRoZSBPYmplY3RJRCBhcyBpdCBpcyBub3QgYSBzdHJpbmcgaXQgaXMgYW4gb2JqZWN0aWRcclxudmFyIGJvZHlQYXJzZXI9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XHJcblxyXG52YXJ7bW9uZ29vc2V9PSByZXF1aXJlKFwiLi8uLi9kYi9tb25nb29zZS5qc1wiKTsgIFxyXG52YXJ7dHJhY2t9PXJlcXVpcmUoXCIuLy4uL21vZGVscy90cmFjay5qc1wiKTtcclxudmFye1VzZXJ9PSByZXF1aXJlKFwiLi8uLi9tb2RlbHMvdXNlcnMuanNcIik7IC8vIHVzZXJzIG1vZGVsXHJcbnZhcntwbGF5bGlzdH09IHJlcXVpcmUoXCIuLy4uL21vZGVscy9wbGF5bGlzdHMuanNcIik7IC8vIHBsYXlsaXN0cyBtb2RlbFxyXG5cclxuXHJcbnZhciBhcHA9ZXhwcmVzcygpO1xyXG4vL2NvbmZpZ3VyZXMgdGhlIG1pZGRsZXdlYXJcclxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XHJcblxyXG5hcHAuZGVsZXRlKCcvcGxheWxpc3RzL3RyYWNrcycsKHJlcSxyZXMpPT57XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIFVzZXIuZmluZEJ5VG9rZW4odG9rZW4pLnRoZW4oKHVzZXIpPT57XHJcbiAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcbiAgICB2YXIgdXNlcklkMj11c2VyLl9pZDsgICAgIC8vIGlkIG9mIHRoZSBvd25lciBvZiB0aGUgcGxheWxpc3QgXHJcbiAgICBpZighcmVxLmJvZHkucGxheWxpc3ROYW1lKXtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJQYXNzIHRoZSBwbGF5bGlzdG5hbWUgdGhhdCB5b3Ugd2FudCB0byBkZWxldGUgYSB0cmFjayBmcm9tXCIpO1xyXG4gICAgfVxyXG4gICAgaWYoIXJlcS5ib2R5LnRyYWNrSWQpe1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlBhc3MgdGhlIHRyYWNrIGlkIHRoYXQgeW91IHdhbnQgdG8gZGVsZXRlXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRyYWNrSWQ9IHJlcS5ib2R5LnRyYWNrSWRcclxuICAgIGlmKCFPYmplY3RJRC5pc1ZhbGlkKHRyYWNrSWQpKXtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJJbnZhbGlkIFRyYWNrIElkXCIpOyAgIFxyXG4gICAgfVxyXG5cclxuICAgIHZhciBwbGF5bGlzdE5hbWU9cmVxLmJvZHkucGxheWxpc3ROYW1lO1xyXG4gICAgcGxheWxpc3QuZmluZE9uZSh7JGFuZDpbe3VzZXJJZDp1c2VySWQyfSx7cGxheWxpc3ROYW1lOnBsYXlsaXN0TmFtZSB9XX0pLnRoZW4oKGRlbFBsYXlsaXN0KT0+e1xyXG4gICAgICAgIGlmKCFkZWxQbGF5bGlzdCl7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoJ1BsYXlsaXN0IG5vdCBmb3VuZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBwbGF5bGlzdC5maW5kT25lKHskYW5kOlt7dHJhY2tzOnskZXE6dHJhY2tJZH19LHtwbGF5bGlzdE5hbWU6cGxheWxpc3ROYW1lIH1dfSkudGhlbigoZGVsVHJhY2sxKT0+e1xyXG4gICAgICAgICAgICBpZighZGVsVHJhY2sxKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlRyYWNrIGlzIG5vdCBpbiB0aGUgcGxheWxpc3RcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHZhciB0cmFja3NhcnI9IGRlbFRyYWNrMS50cmFja3M7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGNvdW50PTAgOyBjb3VudDx0cmFja3NhcnIubGVuZ3RoO2NvdW50Kyspe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRyYWNrc2Fycltjb3VudF09PXRyYWNrSWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcHRyYWNrPXRyYWNrc2Fycltjb3VudF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGNvdW50Mj1jb3VudCA7IGNvdW50Mjx0cmFja3NhcnIubGVuZ3RoLTEgOyBjb3VudDIrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja3NhcnJbY291bnQyXT10cmFja3NhcnJbY291bnQyKzFdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICB0cmFja3NhcnIucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGxheWxpc3QuZmluZE9uZUFuZFVwZGF0ZSh7JGFuZDpbe3VzZXJJZDp1c2VySWQyfSx7cGxheWxpc3ROYW1lOnBsYXlsaXN0TmFtZSB9XX0seyAkc2V0OiB7IHRyYWNrczp0cmFja3NhcnIgIH0gfSkudGhlbigocmVzKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChcIlRyYWNrIGlzIHN1Y2Nlc3NmdWxseSBkZWxldGVkIGZyb20gcGxheWxpc3RcIik7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KS5jYXRjaCgoZSk9PntcclxuICAgICAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChcIkNvdWxkIG5vdCByZW1vdmUgdGhlIHRyYWNrIGZyb20gdGhlIHBsYXlsaXN0XCIpO1xyXG4gICAgfSlcclxuICAgIH0pLmNhdGNoKChlKT0+e1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCdVbmF1dGhvcml6ZWQgQWNjZXNzJyk7XHJcbiAgICB9KVxyXG59KTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5pZighbW9kdWxlLnBhcmVudCl7XHJcbiAgICBhcHAubGlzdGVuKDMwMDAsKCk9PntcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0ZWQgb24gcG9ydCAzMDAwXCIpO1xyXG4gICAgfSk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHM9e2FwcH07XHJcblxyXG5cclxuXHJcbiJdfQ==