function cov_h1nzizzxz(){var path="C:\\Users\\Dell\\Desktop\\error\\Services\\addtrack.js";var hash="3f362621d4d05aae37c4d7bb446d6611dd6e8f48";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Dell\\Desktop\\error\\Services\\addtrack.js",statementMap:{"0":{start:{line:2,column:15},end:{line:2,column:33}},"1":{start:{line:3,column:16},end:{line:3,column:38}},"2":{start:{line:4,column:17},end:{line:4,column:35}},"3":{start:{line:7,column:15},end:{line:7,column:45}},"4":{start:{line:8,column:11},end:{line:8,column:42}},"5":{start:{line:9,column:13},end:{line:9,column:46}},"6":{start:{line:10,column:13},end:{line:10,column:45}},"7":{start:{line:14,column:8},end:{line:14,column:17}},"8":{start:{line:16,column:0},end:{line:16,column:27}},"9":{start:{line:20,column:0},end:{line:101,column:3}},"10":{start:{line:21,column:16},end:{line:21,column:36}},"11":{start:{line:22,column:4},end:{line:100,column:6}},"12":{start:{line:23,column:8},end:{line:25,column:9}},"13":{start:{line:24,column:12},end:{line:24,column:36}},"14":{start:{line:26,column:23},end:{line:26,column:35}},"15":{start:{line:27,column:8},end:{line:29,column:9}},"16":{start:{line:28,column:12},end:{line:28,column:66}},"17":{start:{line:30,column:8},end:{line:32,column:9}},"18":{start:{line:31,column:12},end:{line:31,column:67}},"19":{start:{line:33,column:8},end:{line:35,column:9}},"20":{start:{line:34,column:11},end:{line:34,column:67}},"21":{start:{line:36,column:8},end:{line:38,column:9}},"22":{start:{line:37,column:12},end:{line:37,column:65}},"23":{start:{line:39,column:8},end:{line:41,column:9}},"24":{start:{line:40,column:12},end:{line:40,column:70}},"25":{start:{line:43,column:8},end:{line:45,column:9}},"26":{start:{line:44,column:12},end:{line:44,column:82}},"27":{start:{line:47,column:8},end:{line:93,column:11}},"28":{start:{line:48,column:12},end:{line:51,column:13}},"29":{start:{line:49,column:16},end:{line:49,column:77}},"30":{start:{line:53,column:12},end:{line:64,column:15}},"31":{start:{line:54,column:16},end:{line:63,column:21}},"32":{start:{line:55,column:24},end:{line:58,column:54}},"33":{start:{line:59,column:24},end:{line:59,column:42}},"34":{start:{line:61,column:25},end:{line:63,column:21}},"35":{start:{line:62,column:24},end:{line:62,column:42}},"36":{start:{line:68,column:12},end:{line:90,column:15}},"37":{start:{line:69,column:16},end:{line:89,column:17}},"38":{start:{line:70,column:44},end:{line:80,column:22}},"39":{start:{line:79,column:24},end:{line:79,column:93}},"40":{start:{line:82,column:20},end:{line:84,column:22}},"41":{start:{line:83,column:24},end:{line:83,column:50}},"42":{start:{line:87,column:21},end:{line:89,column:17}},"43":{start:{line:88,column:20},end:{line:88,column:138}},"44":{start:{line:99,column:8},end:{line:99,column:52}},"45":{start:{line:105,column:0},end:{line:109,column:1}},"46":{start:{line:106,column:4},end:{line:108,column:7}},"47":{start:{line:107,column:8},end:{line:107,column:44}},"48":{start:{line:111,column:0},end:{line:111,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:20,column:19},end:{line:20,column:20}},loc:{start:{line:20,column:30},end:{line:101,column:1}},line:20},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:35},end:{line:22,column:36}},loc:{start:{line:22,column:47},end:{line:98,column:5}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:47,column:47},end:{line:47,column:48}},loc:{start:{line:47,column:62},end:{line:93,column:9}},line:47},"3":{name:"(anonymous_3)",decl:{start:{line:53,column:58},end:{line:53,column:59}},loc:{start:{line:53,column:69},end:{line:64,column:13}},line:53},"4":{name:"(anonymous_4)",decl:{start:{line:68,column:91},end:{line:68,column:92}},loc:{start:{line:68,column:109},end:{line:90,column:13}},line:68},"5":{name:"(anonymous_5)",decl:{start:{line:78,column:22},end:{line:78,column:23}},loc:{start:{line:78,column:27},end:{line:80,column:21}},line:78},"6":{name:"(anonymous_6)",decl:{start:{line:82,column:46},end:{line:82,column:47}},loc:{start:{line:82,column:53},end:{line:84,column:21}},line:82},"7":{name:"(anonymous_7)",decl:{start:{line:98,column:13},end:{line:98,column:14}},loc:{start:{line:98,column:18},end:{line:100,column:5}},line:98},"8":{name:"(anonymous_8)",decl:{start:{line:106,column:20},end:{line:106,column:21}},loc:{start:{line:106,column:24},end:{line:108,column:5}},line:106}},branchMap:{"0":{loc:{start:{line:23,column:8},end:{line:25,column:9}},type:"if",locations:[{start:{line:23,column:8},end:{line:25,column:9}},{start:{line:23,column:8},end:{line:25,column:9}}],line:23},"1":{loc:{start:{line:27,column:8},end:{line:29,column:9}},type:"if",locations:[{start:{line:27,column:8},end:{line:29,column:9}},{start:{line:27,column:8},end:{line:29,column:9}}],line:27},"2":{loc:{start:{line:30,column:8},end:{line:32,column:9}},type:"if",locations:[{start:{line:30,column:8},end:{line:32,column:9}},{start:{line:30,column:8},end:{line:32,column:9}}],line:30},"3":{loc:{start:{line:33,column:8},end:{line:35,column:9}},type:"if",locations:[{start:{line:33,column:8},end:{line:35,column:9}},{start:{line:33,column:8},end:{line:35,column:9}}],line:33},"4":{loc:{start:{line:36,column:8},end:{line:38,column:9}},type:"if",locations:[{start:{line:36,column:8},end:{line:38,column:9}},{start:{line:36,column:8},end:{line:38,column:9}}],line:36},"5":{loc:{start:{line:39,column:8},end:{line:41,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:41,column:9}},{start:{line:39,column:8},end:{line:41,column:9}}],line:39},"6":{loc:{start:{line:43,column:8},end:{line:45,column:9}},type:"if",locations:[{start:{line:43,column:8},end:{line:45,column:9}},{start:{line:43,column:8},end:{line:45,column:9}}],line:43},"7":{loc:{start:{line:43,column:11},end:{line:43,column:81}},type:"binary-expr",locations:[{start:{line:43,column:11},end:{line:43,column:33}},{start:{line:43,column:37},end:{line:43,column:58}},{start:{line:43,column:62},end:{line:43,column:81}}],line:43},"8":{loc:{start:{line:48,column:12},end:{line:51,column:13}},type:"if",locations:[{start:{line:48,column:12},end:{line:51,column:13}},{start:{line:48,column:12},end:{line:51,column:13}}],line:48},"9":{loc:{start:{line:54,column:16},end:{line:63,column:21}},type:"if",locations:[{start:{line:54,column:16},end:{line:63,column:21}},{start:{line:54,column:16},end:{line:63,column:21}}],line:54},"10":{loc:{start:{line:61,column:25},end:{line:63,column:21}},type:"if",locations:[{start:{line:61,column:25},end:{line:63,column:21}},{start:{line:61,column:25},end:{line:63,column:21}}],line:61},"11":{loc:{start:{line:69,column:16},end:{line:89,column:17}},type:"if",locations:[{start:{line:69,column:16},end:{line:89,column:17}},{start:{line:69,column:16},end:{line:89,column:17}}],line:69},"12":{loc:{start:{line:87,column:21},end:{line:89,column:17}},type:"if",locations:[{start:{line:87,column:21},end:{line:89,column:17}},{start:{line:87,column:21},end:{line:89,column:17}}],line:87},"13":{loc:{start:{line:105,column:0},end:{line:109,column:1}},type:"if",locations:[{start:{line:105,column:0},end:{line:109,column:1}},{start:{line:105,column:0},end:{line:109,column:1}}],line:105}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3f362621d4d05aae37c4d7bb446d6611dd6e8f48"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_h1nzizzxz=function(){return actualCoverage;};return actualCoverage;}cov_h1nzizzxz();//library imports
const express=(cov_h1nzizzxz().s[0]++,require('express'));var bodyParser=(cov_h1nzizzxz().s[1]++,require('body-parser'));const{ObjectID}=(cov_h1nzizzxz().s[2]++,require("mongodb"));//local imports
var{mongoose}=(cov_h1nzizzxz().s[3]++,require("./../db/mongoose.js"));var{track}=(cov_h1nzizzxz().s[4]++,require("./../models/track.js"));var{artist}=(cov_h1nzizzxz().s[5]++,require("./../models/Artists.js"));//artists model
var{images}=(cov_h1nzizzxz().s[6]++,require("./../models/images.js"));// images model
///////////
var app=(cov_h1nzizzxz().s[7]++,express());//configures the middlewear
cov_h1nzizzxz().s[8]++;app.use(bodyParser.json());//post fn takes the url as first paramter and a call back fn 
//the user id is to be passed in the url to know whom this playlist belongs to
cov_h1nzizzxz().s[9]++;app.post('/tracks',(req,res)=>{cov_h1nzizzxz().f[0]++;var token=(cov_h1nzizzxz().s[10]++,req.header('x-auth'));cov_h1nzizzxz().s[11]++;artist.findByToken(token).then(myartist=>{cov_h1nzizzxz().f[1]++;cov_h1nzizzxz().s[12]++;if(!myartist){cov_h1nzizzxz().b[0][0]++;cov_h1nzizzxz().s[13]++;return Promise.reject();}else{cov_h1nzizzxz().b[0][1]++;}var atristId2=(cov_h1nzizzxz().s[14]++,myartist._id);cov_h1nzizzxz().s[15]++;if(!req.body.trackName){cov_h1nzizzxz().b[1][0]++;cov_h1nzizzxz().s[16]++;return res.status(400).send("Track name is required");}else{cov_h1nzizzxz().b[1][1]++;}cov_h1nzizzxz().s[17]++;if(!req.body.genre){cov_h1nzizzxz().b[2][0]++;cov_h1nzizzxz().s[18]++;return res.status(400).send("Track genre is required");}else{cov_h1nzizzxz().b[2][1]++;}cov_h1nzizzxz().s[19]++;if(!req.body.image){cov_h1nzizzxz().b[3][0]++;cov_h1nzizzxz().s[20]++;return res.status(400).send("Track image is required");}else{cov_h1nzizzxz().b[3][1]++;}cov_h1nzizzxz().s[21]++;if(!req.body.url){cov_h1nzizzxz().b[4][0]++;cov_h1nzizzxz().s[22]++;return res.status(400).send("Track url is required");}else{cov_h1nzizzxz().b[4][1]++;}cov_h1nzizzxz().s[23]++;if(!req.body.duration){cov_h1nzizzxz().b[5][0]++;cov_h1nzizzxz().s[24]++;return res.status(400).send("Track duration is required");}else{cov_h1nzizzxz().b[5][1]++;}//IF HEIGHT AND WIDTH ARE NOT REQUIRED -> TO BE REMOVED FROM THE OR CONDITION HERE
cov_h1nzizzxz().s[25]++;if((cov_h1nzizzxz().b[7][0]++,!req.body.image.height)||(cov_h1nzizzxz().b[7][1]++,!req.body.image.width)||(cov_h1nzizzxz().b[7][2]++,!req.body.image.url)){cov_h1nzizzxz().b[6][0]++;cov_h1nzizzxz().s[26]++;return res.status(400).send("Image Info of track has to be provided");}else{cov_h1nzizzxz().b[6][1]++;}cov_h1nzizzxz().s[27]++;track.findOne({url:req.body.url}).then(duptrackurl=>{cov_h1nzizzxz().f[2]++;cov_h1nzizzxz().s[28]++;if(duptrackurl){cov_h1nzizzxz().b[8][0]++;cov_h1nzizzxz().s[29]++;return res.status(409).send("This track is already created");}else{cov_h1nzizzxz().b[8][1]++;}var savedImage;cov_h1nzizzxz().s[30]++;images.findOne({url:req.body.image.url}).then(isImage=>{cov_h1nzizzxz().f[3]++;cov_h1nzizzxz().s[31]++;if(!isImage){cov_h1nzizzxz().b[9][0]++;cov_h1nzizzxz().s[32]++;savedImage=new images({url:req.body.image.url,height:req.body.image.height,width:req.body.image.width});cov_h1nzizzxz().s[33]++;savedImage.save();}else{cov_h1nzizzxz().b[9][1]++;cov_h1nzizzxz().s[34]++;if(isImage){cov_h1nzizzxz().b[10][0]++;cov_h1nzizzxz().s[35]++;savedImage=isImage;}else{cov_h1nzizzxz().b[10][1]++;}}});cov_h1nzizzxz().s[36]++;track.find({$and:[{artistId:atristId2},{trackName:req.body.trackName}]}).then(trackduplicate=>{cov_h1nzizzxz().f[4]++;cov_h1nzizzxz().s[37]++;if(trackduplicate.length==0){cov_h1nzizzxz().b[11][0]++;var trackInstance=(cov_h1nzizzxz().s[38]++,new track({artistId:atristId2,trackName:req.body.trackName,duration:req.body.duration,url:req.body.url,image:savedImage,genre:req.body.genre},e=>{cov_h1nzizzxz().f[5]++;cov_h1nzizzxz().s[39]++;res.status(500).send("Coult not add Track ("+req.body.trackName+")");}));cov_h1nzizzxz().s[40]++;trackInstance.save().then(doc=>{cov_h1nzizzxz().f[6]++;cov_h1nzizzxz().s[41]++;res.status(201).send(doc);});}else{cov_h1nzizzxz().b[11][1]++;cov_h1nzizzxz().s[42]++;if(trackduplicate.length!=0){cov_h1nzizzxz().b[12][0]++;cov_h1nzizzxz().s[43]++;//409 is code for conflict
return res.status(409).send("Cannot create 2 Tracks with the same name ("+req.body.trackName+") for the same artist");}else{cov_h1nzizzxz().b[12][1]++;}};});});}).catch(e=>{cov_h1nzizzxz().f[7]++;cov_h1nzizzxz().s[44]++;res.status(401).send('Unauthorized Access');});});cov_h1nzizzxz().s[45]++;if(!module.parent){cov_h1nzizzxz().b[13][0]++;cov_h1nzizzxz().s[46]++;app.listen(3000,()=>{cov_h1nzizzxz().f[8]++;cov_h1nzizzxz().s[47]++;console.log("Started on port 3000");});}else{cov_h1nzizzxz().b[13][1]++;}cov_h1nzizzxz().s[48]++;module.exports={app};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZHRyYWNrLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYm9keVBhcnNlciIsIk9iamVjdElEIiwibW9uZ29vc2UiLCJ0cmFjayIsImFydGlzdCIsImltYWdlcyIsImFwcCIsInVzZSIsImpzb24iLCJwb3N0IiwicmVxIiwicmVzIiwidG9rZW4iLCJoZWFkZXIiLCJmaW5kQnlUb2tlbiIsInRoZW4iLCJteWFydGlzdCIsIlByb21pc2UiLCJyZWplY3QiLCJhdHJpc3RJZDIiLCJfaWQiLCJib2R5IiwidHJhY2tOYW1lIiwic3RhdHVzIiwic2VuZCIsImdlbnJlIiwiaW1hZ2UiLCJ1cmwiLCJkdXJhdGlvbiIsImhlaWdodCIsIndpZHRoIiwiZmluZE9uZSIsImR1cHRyYWNrdXJsIiwic2F2ZWRJbWFnZSIsImlzSW1hZ2UiLCJzYXZlIiwiZmluZCIsIiRhbmQiLCJhcnRpc3RJZCIsInRyYWNrZHVwbGljYXRlIiwibGVuZ3RoIiwidHJhY2tJbnN0YW5jZSIsImUiLCJkb2MiLCJjYXRjaCIsIm1vZHVsZSIsInBhcmVudCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiMDRQQUFBO0FBQ0EsS0FBTUEsQ0FBQUEsT0FBTyx5QkFBRUMsT0FBTyxDQUFDLFNBQUQsQ0FBVCxDQUFiLENBQ0EsR0FBSUMsQ0FBQUEsVUFBVSx5QkFBRUQsT0FBTyxDQUFDLGFBQUQsQ0FBVCxDQUFkLENBQ0EsS0FBTSxDQUFDRSxRQUFELDBCQUFXRixPQUFPLENBQUMsU0FBRCxDQUFsQixDQUFOLENBRUE7QUFDQSxHQUFHLENBQUNHLFFBQUQsMEJBQVlILE9BQU8sQ0FBQyxxQkFBRCxDQUFuQixDQUFILENBQ0EsR0FBRyxDQUFDSSxLQUFELDBCQUFRSixPQUFPLENBQUMsc0JBQUQsQ0FBZixDQUFILENBQ0EsR0FBRyxDQUFDSyxNQUFELDBCQUFVTCxPQUFPLENBQUMsd0JBQUQsQ0FBakIsQ0FBSCxDQUFpRDtBQUNqRCxHQUFHLENB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cmFyeSBpbXBvcnRzXHJcbmNvbnN0IGV4cHJlc3M9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxudmFyIGJvZHlQYXJzZXI9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XHJcbmNvbnN0IHtPYmplY3RJRH09cmVxdWlyZShcIm1vbmdvZGJcIik7XHJcblxyXG4vL2xvY2FsIGltcG9ydHNcclxudmFye21vbmdvb3NlfT0gcmVxdWlyZShcIi4vLi4vZGIvbW9uZ29vc2UuanNcIik7ICBcclxudmFye3RyYWNrfT1yZXF1aXJlKFwiLi8uLi9tb2RlbHMvdHJhY2suanNcIik7XHJcbnZhcnthcnRpc3R9PSByZXF1aXJlKFwiLi8uLi9tb2RlbHMvQXJ0aXN0cy5qc1wiKTsgIC8vYXJ0aXN0cyBtb2RlbFxyXG52YXJ7aW1hZ2VzfT0gcmVxdWlyZShcIi4vLi4vbW9kZWxzL2ltYWdlcy5qc1wiKTsgLy8gaW1hZ2VzIG1vZGVsXHJcblxyXG5cclxuLy8vLy8vLy8vLy9cclxudmFyIGFwcD1leHByZXNzKCk7XHJcbi8vY29uZmlndXJlcyB0aGUgbWlkZGxld2VhclxyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcclxuXHJcbi8vcG9zdCBmbiB0YWtlcyB0aGUgdXJsIGFzIGZpcnN0IHBhcmFtdGVyIGFuZCBhIGNhbGwgYmFjayBmbiBcclxuLy90aGUgdXNlciBpZCBpcyB0byBiZSBwYXNzZWQgaW4gdGhlIHVybCB0byBrbm93IHdob20gdGhpcyBwbGF5bGlzdCBiZWxvbmdzIHRvXHJcbmFwcC5wb3N0KCcvdHJhY2tzJywocmVxLHJlcyk9PntcclxuICAgIHZhciB0b2tlbiA9IHJlcS5oZWFkZXIoJ3gtYXV0aCcpO1xyXG4gICAgYXJ0aXN0LmZpbmRCeVRva2VuKHRva2VuKS50aGVuKChteWFydGlzdCk9PntcclxuICAgICAgICBpZighbXlhcnRpc3Qpe1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGF0cmlzdElkMj0gbXlhcnRpc3QuX2lkOyAgIFxyXG4gICAgICAgIGlmKCFyZXEuYm9keS50cmFja05hbWUpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJUcmFjayBuYW1lIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighcmVxLmJvZHkuZ2VucmUpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJUcmFjayBnZW5yZSBpcyByZXF1aXJlZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIXJlcS5ib2R5LmltYWdlKXtcclxuICAgICAgICAgICByZXR1cm4gIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVHJhY2sgaW1hZ2UgaXMgcmVxdWlyZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFyZXEuYm9keS51cmwpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJUcmFjayB1cmwgaXMgcmVxdWlyZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFyZXEuYm9keS5kdXJhdGlvbil7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlRyYWNrIGR1cmF0aW9uIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL0lGIEhFSUdIVCBBTkQgV0lEVEggQVJFIE5PVCBSRVFVSVJFRCAtPiBUTyBCRSBSRU1PVkVEIEZST00gVEhFIE9SIENPTkRJVElPTiBIRVJFXHJcbiAgICAgICAgaWYoIXJlcS5ib2R5LmltYWdlLmhlaWdodCB8fCAhcmVxLmJvZHkuaW1hZ2Uud2lkdGggfHwgIXJlcS5ib2R5LmltYWdlLnVybCl7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIkltYWdlIEluZm8gb2YgdHJhY2sgaGFzIHRvIGJlIHByb3ZpZGVkXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdHJhY2suZmluZE9uZSh7dXJsOnJlcS5ib2R5LnVybH0pLnRoZW4oKGR1cHRyYWNrdXJsKT0+e1xyXG4gICAgICAgICAgICBpZihkdXB0cmFja3VybCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDkpLnNlbmQoXCJUaGlzIHRyYWNrIGlzIGFscmVhZHkgY3JlYXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzYXZlZEltYWdlO1xyXG4gICAgICAgICAgICBpbWFnZXMuZmluZE9uZSh7dXJsOnJlcS5ib2R5LmltYWdlLnVybH0pLnRoZW4oKGlzSW1hZ2UpPT57XHJcbiAgICAgICAgICAgICAgICBpZighaXNJbWFnZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVkSW1hZ2U9IG5ldyBpbWFnZXMgKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOnJlcS5ib2R5LmltYWdlLnVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OnJlcS5ib2R5LmltYWdlLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6cmVxLmJvZHkuaW1hZ2Uud2lkdGgsfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVkSW1hZ2Uuc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGlzSW1hZ2Upe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlZEltYWdlPWlzSW1hZ2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgICAgICB0cmFjay5maW5kKHskYW5kOlt7YXJ0aXN0SWQ6YXRyaXN0SWQyfSx7dHJhY2tOYW1lOnJlcS5ib2R5LnRyYWNrTmFtZSB9XX0pLnRoZW4oKHRyYWNrZHVwbGljYXRlKT0+e1xyXG4gICAgICAgICAgICAgICAgaWYodHJhY2tkdXBsaWNhdGUubGVuZ3RoPT0wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYWNrSW5zdGFuY2UgPSBuZXcgdHJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnRpc3RJZDogYXRyaXN0SWQyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFja05hbWU6IHJlcS5ib2R5LnRyYWNrTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246cmVxLmJvZHkuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDpyZXEuYm9keS51cmwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOnNhdmVkSW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlbnJlOnJlcS5ib2R5LmdlbnJlLFxyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSwoZSk9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoXCJDb3VsdCBub3QgYWRkIFRyYWNrIChcIityZXEuYm9keS50cmFja05hbWUrXCIpXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tJbnN0YW5jZS5zYXZlKCkudGhlbigoZG9jKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuc2VuZChkb2MpOyAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodHJhY2tkdXBsaWNhdGUubGVuZ3RoIT0wKXsgIC8vNDA5IGlzIGNvZGUgZm9yIGNvbmZsaWN0XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5zZW5kKFwiQ2Fubm90IGNyZWF0ZSAyIFRyYWNrcyB3aXRoIHRoZSBzYW1lIG5hbWUgKFwiK3JlcS5ib2R5LnRyYWNrTmFtZStcIikgZm9yIHRoZSBzYW1lIGFydGlzdFwiKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICBcclxuICAgIH0pLmNhdGNoKChlKT0+e1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCdVbmF1dGhvcml6ZWQgQWNjZXNzJyk7XHJcbiAgICB9KVxyXG59KTtcclxuXHJcbiAgICBcclxuXHJcbmlmKCFtb2R1bGUucGFyZW50KXtcclxuICAgIGFwcC5saXN0ZW4oMzAwMCwoKT0+e1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRlZCBvbiBwb3J0IDMwMDBcIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHM9e2FwcH07XHJcblxyXG5cclxuIl19