function cov_16wubvurjo(){var path="G:\\SWbackend\\Integrated\\Backend-team\\Controllers\\SearchController.js";var hash="8d989aabab1a080edeeec337277f4db9bba76ae0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"G:\\SWbackend\\Integrated\\Backend-team\\Controllers\\SearchController.js",statementMap:{"0":{start:{line:2,column:19},end:{line:2,column:49}},"1":{start:{line:4,column:14},end:{line:4,column:32}},"2":{start:{line:5,column:15},end:{line:5,column:24}},"3":{start:{line:7,column:8},end:{line:7,column:25}},"4":{start:{line:10,column:12},end:{line:10,column:35}},"5":{start:{line:15,column:22},end:{line:15,column:60}},"6":{start:{line:16,column:23},end:{line:16,column:62}},"7":{start:{line:17,column:22},end:{line:17,column:60}},"8":{start:{line:18,column:25},end:{line:18,column:66}},"9":{start:{line:19,column:21},end:{line:19,column:58}},"10":{start:{line:22,column:29},end:{line:22,column:75}},"11":{start:{line:25,column:0},end:{line:49,column:6}},"12":{start:{line:26,column:31},end:{line:26,column:45}},"13":{start:{line:27,column:12},end:{line:27,column:38}},"14":{start:{line:29,column:12},end:{line:46,column:60}},"15":{start:{line:30,column:16},end:{line:44,column:64}},"16":{start:{line:31,column:20},end:{line:43,column:68}},"17":{start:{line:32,column:24},end:{line:32,column:56}},"18":{start:{line:33,column:24},end:{line:41,column:72}},"19":{start:{line:34,column:28},end:{line:34,column:59}},"20":{start:{line:36,column:28},end:{line:40,column:77}},"21":{start:{line:37,column:32},end:{line:37,column:67}},"22":{start:{line:39,column:33},end:{line:39,column:128}},"23":{start:{line:40,column:49},end:{line:40,column:74}},"24":{start:{line:41,column:44},end:{line:41,column:69}},"25":{start:{line:43,column:40},end:{line:43,column:65}},"26":{start:{line:44,column:36},end:{line:44,column:61}},"27":{start:{line:46,column:32},end:{line:46,column:57}},"28":{start:{line:116,column:4},end:{line:116,column:26}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:25,column:21},end:{line:25,column:22}},loc:{start:{line:25,column:35},end:{line:49,column:5}},line:25},"1":{name:"(anonymous_1)",decl:{start:{line:29,column:62},end:{line:29,column:63}},loc:{start:{line:29,column:75},end:{line:46,column:13}},line:29},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:72},end:{line:30,column:73}},loc:{start:{line:30,column:84},end:{line:44,column:17}},line:30},"3":{name:"(anonymous_3)",decl:{start:{line:31,column:77},end:{line:31,column:78}},loc:{start:{line:31,column:89},end:{line:43,column:21}},line:31},"4":{name:"(anonymous_4)",decl:{start:{line:33,column:70},end:{line:33,column:71}},loc:{start:{line:33,column:81},end:{line:41,column:25}},line:33},"5":{name:"(anonymous_5)",decl:{start:{line:36,column:82},end:{line:36,column:83}},loc:{start:{line:36,column:97},end:{line:40,column:30}},line:36},"6":{name:"(anonymous_6)",decl:{start:{line:40,column:38},end:{line:40,column:39}},loc:{start:{line:40,column:47},end:{line:40,column:76}},line:40},"7":{name:"(anonymous_7)",decl:{start:{line:41,column:33},end:{line:41,column:34}},loc:{start:{line:41,column:42},end:{line:41,column:71}},line:41},"8":{name:"(anonymous_8)",decl:{start:{line:43,column:29},end:{line:43,column:30}},loc:{start:{line:43,column:38},end:{line:43,column:67}},line:43},"9":{name:"(anonymous_9)",decl:{start:{line:44,column:25},end:{line:44,column:26}},loc:{start:{line:44,column:34},end:{line:44,column:63}},line:44},"10":{name:"(anonymous_10)",decl:{start:{line:46,column:21},end:{line:46,column:22}},loc:{start:{line:46,column:30},end:{line:46,column:59}},line:46}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8d989aabab1a080edeeec337277f4db9bba76ae0"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_16wubvurjo=function(){return actualCoverage;};return actualCoverage;}cov_16wubvurjo();// JavaScript source code
var{mongoose}=(cov_16wubvurjo().s[0]++,require("./../db/mongoose.js"));//var bodyparser = require('body-parser');
var express=(cov_16wubvurjo().s[1]++,require('express'));const router=(cov_16wubvurjo().s[2]++,express());var _=(cov_16wubvurjo().s[3]++,require('lodash'));//var rand=Math.floor((Math.random() * 100) + 54); //random confirmation code
const jwt=(cov_16wubvurjo().s[4]++,require('jsonwebtoken'));/*var { album } = require("../models/album.js");
var { artist } = require("../models/artists.js");
const { track } = require("./../models/track");*/const trackservices=(cov_16wubvurjo().s[5]++,require("./../Services/TrackServices"));const artistservices=(cov_16wubvurjo().s[6]++,require("./../Services/ArtistServices"));const albumservices=(cov_16wubvurjo().s[7]++,require("./../Services/AlbumServices"));const playlistservices=(cov_16wubvurjo().s[8]++,require("./../Services/PlaylistServices"));const userservices=(cov_16wubvurjo().s[9]++,require("./../Services/UserServices"));var AuthenticationServices=(cov_16wubvurjo().s[10]++,require("./../Services/AuthenticationService"));//{ $regex: "s", $options: "i" }
//AuthenticationServices.AuthenticateAllUsers
cov_16wubvurjo().s[11]++;router.get('/Search',(req,res)=>{cov_16wubvurjo().f[0]++;var wordtosearch=(cov_16wubvurjo().s[12]++,req.query.word);cov_16wubvurjo().s[13]++;console.log(wordtosearch);//Return array of tracks
cov_16wubvurjo().s[14]++;artistservices.SearchInArtists(wordtosearch).then(Artists=>{cov_16wubvurjo().f[1]++;cov_16wubvurjo().s[15]++;albumservices.SearchInAlbums(wordtosearch,Artists).then(Albums=>{cov_16wubvurjo().f[2]++;cov_16wubvurjo().s[16]++;trackservices.SearchInTracks(wordtosearch,Artists).then(Tracks=>{cov_16wubvurjo().f[3]++;cov_16wubvurjo().s[17]++;console.log("5alas 2el tracks");cov_16wubvurjo().s[18]++;userservices.SearchInUsers(wordtosearch).then(Users=>{cov_16wubvurjo().f[4]++;cov_16wubvurjo().s[19]++;console.log("5alas 2el Users");cov_16wubvurjo().s[20]++;playlistservices.SearchInPlaylists(wordtosearch).then(Playlists=>{cov_16wubvurjo().f[5]++;cov_16wubvurjo().s[21]++;console.log("5alas 2el Playlists");cov_16wubvurjo().s[22]++;res.send({artists:Artists,Albums:Albums,Tracks:Tracks,Playlists:Playlists,Users:Users});}).catch(err=>{cov_16wubvurjo().f[6]++;cov_16wubvurjo().s[23]++;res.status(400).send(err);});}).catch(err=>{cov_16wubvurjo().f[7]++;cov_16wubvurjo().s[24]++;res.status(400).send(err);});}).catch(err=>{cov_16wubvurjo().f[8]++;cov_16wubvurjo().s[25]++;res.status(400).send(err);});}).catch(err=>{cov_16wubvurjo().f[9]++;cov_16wubvurjo().s[26]++;res.status(400).send(err);});}).catch(err=>{cov_16wubvurjo().f[10]++;cov_16wubvurjo().s[27]++;res.status(400).send(err);});});// Get User Profile Request
/*app.get('/Search', (req, res) => {
    var token = req.header('x-auth');
    try {
        jwt.verify(token, 'secretkeyforuser')

        var wordtosearch = req.query.word;
        console.log(wordtosearch);
        //Return array of tracks
        artistservices.SearchInArtists(wordtosearch).then((Artists) => {
            albumservices.SearchInAlbums(wordtosearch).then((Albums) => {
                trackservices.SearchInTracks(wordtosearch).then((Tracks) => {
                    console.log("fkdsffdfkdlsfksl");
                    res.send({ artists: Artists, Albums: Albums, Tracks: Tracks });
                }).catch((err) => { res.status(404).send(err) })
            }).catch((err) => { res.status(404).send(err) })

        }).catch((err) => { res.status(404).send(err) })
    }s
    catch (error) {
        console.log("enta hena ezayyyy");
        try {
            console.log("da5a5aalapd");
            jwt.verify(token, 'secretkeyforartist')
            var wordtosearch = req.query.word;
            console.log(wordtosearch);
            //Return array of tracks
            artistservices.SearchInArtists(wordtosearch).then((Artists) => {
                albumservices.SearchInAlbums(wordtosearch).then((Albums) => {
                    trackservices.SearchInTracks(wordtosearch).then((Tracks) => {
                        console.log("fkdsffdfkdlsfksl");
                        res.send({ artists: Artists, Albums: Albums, Tracks: Tracks });
                    }).catch((err) => { res.status(400).send(err) })
                }).catch((err) => { res.status(400).send(err) })

            }).catch((err) => { res.status(400).send(err) })
        }
        catch (err) {
            console.log(err);
            return res.status(401).send("Token is not valid");
        }
    } 
    })   */ /* */ /* try {
        console.log({ artists: artistservices.SearchInArtists(wordtosearch), albums: albumservices.SearchInAlbums(wordtosearch), tracks: trackservices.SearchInTracks(wordtosearch) });
        res.send("")
    }
    catch (err) { res.status(404).send(err) }
    console.log("taba3");
    
   // res.send("dlfksdl");
  /*  track.find({ trackName: wordtosearch }).then((err, tracks) => {
        console.log(tracks);
        var trackids = tracks.map(function (value) { return value._id });
        res.status(200).send(tracksids);

    }).catch((err) => {
        console.log(err);
        res.status(404).send(err);

    })*/cov_16wubvurjo().s[28]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlYXJjaENvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIl8iLCJqd3QiLCJ0cmFja3NlcnZpY2VzIiwiYXJ0aXN0c2VydmljZXMiLCJhbGJ1bXNlcnZpY2VzIiwicGxheWxpc3RzZXJ2aWNlcyIsInVzZXJzZXJ2aWNlcyIsIkF1dGhlbnRpY2F0aW9uU2VydmljZXMiLCJnZXQiLCJyZXEiLCJyZXMiLCJ3b3JkdG9zZWFyY2giLCJxdWVyeSIsIndvcmQiLCJjb25zb2xlIiwibG9nIiwiU2VhcmNoSW5BcnRpc3RzIiwidGhlbiIsIkFydGlzdHMiLCJTZWFyY2hJbkFsYnVtcyIsIkFsYnVtcyIsIlNlYXJjaEluVHJhY2tzIiwiVHJhY2tzIiwiU2VhcmNoSW5Vc2VycyIsIlVzZXJzIiwiU2VhcmNoSW5QbGF5bGlzdHMiLCJQbGF5bGlzdHMiLCJzZW5kIiwiYXJ0aXN0cyIsImNhdGNoIiwiZXJyIiwic3RhdHVzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjBwSUFBQTtBQUNBLEdBQUksQ0FBRUEsUUFBRiwyQkFBZUMsT0FBTyxDQUFDLHFCQUFELENBQXRCLENBQUosQ0FDQTtBQUNBLEdBQUlDLENBQUFBLE9BQU8sMEJBQUdELE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1FLENBQUFBLE1BQU0sMEJBQUdELE9BQU8sRUFBVixDQUFaLENBRUEsR0FBSUUsQ0FBQUEsQ0FBQywwQkFBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFMLENBQ0E7QUFFQSxLQUFNSSxDQUFBQSxHQUFHLDBCQUFHSixPQUFPLENBQUMsY0FBRCxDQUFWLENBQVQsQ0FFQTs7aURBR0EsS0FBTUssQ0FBQUEsYUFBYSwwQkFBR0wsT0FBTyxDQUFDLDZCQUFELENBQVYsQ0FBbkIsQ0FDQSxLQUFNTSxDQUFBQSxjQUFjLDBCQUFHTixPQUFPLENBQUMsOEJBQUQsQ0FBVixDQUFwQixDQUNBLEtBQU1P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c2UgfSA9IHJlcXVpcmUoXCIuLy4uL2RiL21vbmdvb3NlLmpzXCIpO1xyXG4vL3ZhciBib2R5cGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcclxudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MoKTtcclxuXHJcbnZhciBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcbi8vdmFyIHJhbmQ9TWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyA1NCk7IC8vcmFuZG9tIGNvbmZpcm1hdGlvbiBjb2RlXHJcblxyXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuXHJcbi8qdmFyIHsgYWxidW0gfSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvYWxidW0uanNcIik7XHJcbnZhciB7IGFydGlzdCB9ID0gcmVxdWlyZShcIi4uL21vZGVscy9hcnRpc3RzLmpzXCIpO1xyXG5jb25zdCB7IHRyYWNrIH0gPSByZXF1aXJlKFwiLi8uLi9tb2RlbHMvdHJhY2tcIik7Ki9cclxuY29uc3QgdHJhY2tzZXJ2aWNlcyA9IHJlcXVpcmUoXCIuLy4uL1NlcnZpY2VzL1RyYWNrU2VydmljZXNcIik7XHJcbmNvbnN0IGFydGlzdHNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvQXJ0aXN0U2VydmljZXNcIik7XHJcbmNvbnN0IGFsYnVtc2VydmljZXMgPSByZXF1aXJlKFwiLi8uLi9TZXJ2aWNlcy9BbGJ1bVNlcnZpY2VzXCIpO1xyXG5jb25zdCBwbGF5bGlzdHNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvUGxheWxpc3RTZXJ2aWNlc1wiKTtcclxuY29uc3QgdXNlcnNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvVXNlclNlcnZpY2VzXCIpO1xyXG5cclxuXHJcbnZhciBBdXRoZW50aWNhdGlvblNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvQXV0aGVudGljYXRpb25TZXJ2aWNlXCIpO1xyXG4vL3sgJHJlZ2V4OiBcInNcIiwgJG9wdGlvbnM6IFwiaVwiIH1cclxuLy9BdXRoZW50aWNhdGlvblNlcnZpY2VzLkF1dGhlbnRpY2F0ZUFsbFVzZXJzXHJcbnJvdXRlci5nZXQoJy9TZWFyY2gnLChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgICAgICB2YXIgd29yZHRvc2VhcmNoID0gcmVxLnF1ZXJ5LndvcmQ7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmR0b3NlYXJjaCk7XHJcbiAgICAgICAgICAgIC8vUmV0dXJuIGFycmF5IG9mIHRyYWNrc1xyXG4gICAgICAgICAgICBhcnRpc3RzZXJ2aWNlcy5TZWFyY2hJbkFydGlzdHMod29yZHRvc2VhcmNoKS50aGVuKChBcnRpc3RzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBhbGJ1bXNlcnZpY2VzLlNlYXJjaEluQWxidW1zKHdvcmR0b3NlYXJjaCxBcnRpc3RzKS50aGVuKChBbGJ1bXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFja3NlcnZpY2VzLlNlYXJjaEluVHJhY2tzKHdvcmR0b3NlYXJjaCwgQXJ0aXN0cykudGhlbigoVHJhY2tzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiNWFsYXMgMmVsIHRyYWNrc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnNlcnZpY2VzLlNlYXJjaEluVXNlcnMod29yZHRvc2VhcmNoKS50aGVuKChVc2VycykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCI1YWxhcyAyZWwgVXNlcnNcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWxpc3RzZXJ2aWNlcy5TZWFyY2hJblBsYXlsaXN0cyh3b3JkdG9zZWFyY2gpLnRoZW4oKFBsYXlsaXN0cykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiNWFsYXMgMmVsIFBsYXlsaXN0c1wiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgYXJ0aXN0czogQXJ0aXN0cywgQWxidW1zOiBBbGJ1bXMsIFRyYWNrczogVHJhY2tzLFBsYXlsaXN0czpQbGF5bGlzdHMsVXNlcnM6VXNlcnMgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4geyByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKSB9KVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7IHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycikgfSlcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKSB9KVxyXG5cclxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4geyByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpIH0pXHJcbiAgICAgXHJcbiAgXHJcbiAgICB9KSAgIFxyXG4vLyBHZXQgVXNlciBQcm9maWxlIFJlcXVlc3RcclxuLyphcHAuZ2V0KCcvU2VhcmNoJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgand0LnZlcmlmeSh0b2tlbiwgJ3NlY3JldGtleWZvcnVzZXInKVxyXG5cclxuICAgICAgICB2YXIgd29yZHRvc2VhcmNoID0gcmVxLnF1ZXJ5LndvcmQ7XHJcbiAgICAgICAgY29uc29sZS5sb2cod29yZHRvc2VhcmNoKTtcclxuICAgICAgICAvL1JldHVybiBhcnJheSBvZiB0cmFja3NcclxuICAgICAgICBhcnRpc3RzZXJ2aWNlcy5TZWFyY2hJbkFydGlzdHMod29yZHRvc2VhcmNoKS50aGVuKChBcnRpc3RzKSA9PiB7XHJcbiAgICAgICAgICAgIGFsYnVtc2VydmljZXMuU2VhcmNoSW5BbGJ1bXMod29yZHRvc2VhcmNoKS50aGVuKChBbGJ1bXMpID0+IHtcclxuICAgICAgICAgICAgICAgIHRyYWNrc2VydmljZXMuU2VhcmNoSW5UcmFja3Mod29yZHRvc2VhcmNoKS50aGVuKChUcmFja3MpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZrZHNmZmRma2Rsc2Zrc2xcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnNlbmQoeyBhcnRpc3RzOiBBcnRpc3RzLCBBbGJ1bXM6IEFsYnVtcywgVHJhY2tzOiBUcmFja3MgfSk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7IHJlcy5zdGF0dXMoNDA0KS5zZW5kKGVycikgfSlcclxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4geyByZXMuc3RhdHVzKDQwNCkuc2VuZChlcnIpIH0pXHJcblxyXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsgcmVzLnN0YXR1cyg0MDQpLnNlbmQoZXJyKSB9KVxyXG4gICAgfXNcclxuICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZW50YSBoZW5hIGV6YXl5eXlcIik7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJkYTVhNWFhbGFwZFwiKTtcclxuICAgICAgICAgICAgand0LnZlcmlmeSh0b2tlbiwgJ3NlY3JldGtleWZvcmFydGlzdCcpXHJcbiAgICAgICAgICAgIHZhciB3b3JkdG9zZWFyY2ggPSByZXEucXVlcnkud29yZDtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cod29yZHRvc2VhcmNoKTtcclxuICAgICAgICAgICAgLy9SZXR1cm4gYXJyYXkgb2YgdHJhY2tzXHJcbiAgICAgICAgICAgIGFydGlzdHNlcnZpY2VzLlNlYXJjaEluQXJ0aXN0cyh3b3JkdG9zZWFyY2gpLnRoZW4oKEFydGlzdHMpID0+IHtcclxuICAgICAgICAgICAgICAgIGFsYnVtc2VydmljZXMuU2VhcmNoSW5BbGJ1bXMod29yZHRvc2VhcmNoKS50aGVuKChBbGJ1bXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFja3NlcnZpY2VzLlNlYXJjaEluVHJhY2tzKHdvcmR0b3NlYXJjaCkudGhlbigoVHJhY2tzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmtkc2ZmZGZrZGxzZmtzbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNlbmQoeyBhcnRpc3RzOiBBcnRpc3RzLCBBbGJ1bXM6IEFsYnVtcywgVHJhY2tzOiBUcmFja3MgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4geyByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnIpIH0pXHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7IHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycikgfSlcclxuXHJcbiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsgcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKSB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIlRva2VuIGlzIG5vdCB2YWxpZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9IFxyXG4gICAgfSkgICAqL1xyXG5cclxuIC8qICovLyogdHJ5IHtcclxuICAgICAgICBjb25zb2xlLmxvZyh7IGFydGlzdHM6IGFydGlzdHNlcnZpY2VzLlNlYXJjaEluQXJ0aXN0cyh3b3JkdG9zZWFyY2gpLCBhbGJ1bXM6IGFsYnVtc2VydmljZXMuU2VhcmNoSW5BbGJ1bXMod29yZHRvc2VhcmNoKSwgdHJhY2tzOiB0cmFja3NlcnZpY2VzLlNlYXJjaEluVHJhY2tzKHdvcmR0b3NlYXJjaCkgfSk7XHJcbiAgICAgICAgcmVzLnNlbmQoXCJcIilcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHsgcmVzLnN0YXR1cyg0MDQpLnNlbmQoZXJyKSB9XHJcbiAgICBjb25zb2xlLmxvZyhcInRhYmEzXCIpO1xyXG4gICAgXHJcbiAgIC8vIHJlcy5zZW5kKFwiZGxma3NkbFwiKTtcclxuICAvKiAgdHJhY2suZmluZCh7IHRyYWNrTmFtZTogd29yZHRvc2VhcmNoIH0pLnRoZW4oKGVyciwgdHJhY2tzKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2codHJhY2tzKTtcclxuICAgICAgICB2YXIgdHJhY2tpZHMgPSB0cmFja3MubWFwKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUuX2lkIH0pO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHRyYWNrc2lkcyk7XHJcblxyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDQpLnNlbmQoZXJyKTtcclxuXHJcbiAgICB9KSovXHJcblxyXG5cclxuXHJcbiAgICBcclxuICAgIG1vZHVsZS5leHBvcnRzPXJvdXRlcjtcclxuIl19