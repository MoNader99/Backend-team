function cov_1x1z8irhkk(){var path="C:\\Users\\Dell\\Desktop\\Monica\\Controllers\\PlaylistController.js";var hash="2c9f12c2bd99c5832c9e725ca6445ae14a221705";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Dell\\Desktop\\Monica\\Controllers\\PlaylistController.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:19},end:{line:2,column:47}},"2":{start:{line:3,column:13},end:{line:3,column:39}},"3":{start:{line:4,column:17},end:{line:4,column:50}},"4":{start:{line:5,column:13},end:{line:5,column:42}},"5":{start:{line:7,column:13},end:{line:7,column:45}},"6":{start:{line:9,column:17},end:{line:9,column:35}},"7":{start:{line:11,column:13},end:{line:11,column:29}},"8":{start:{line:19,column:0},end:{line:66,column:3}},"9":{start:{line:21,column:16},end:{line:21,column:36}},"10":{start:{line:22,column:4},end:{line:65,column:6}},"11":{start:{line:23,column:8},end:{line:25,column:9}},"12":{start:{line:24,column:12},end:{line:24,column:36}},"13":{start:{line:26,column:8},end:{line:28,column:9}},"14":{start:{line:27,column:12},end:{line:27,column:69}},"15":{start:{line:34,column:20},end:{line:34,column:28}},"16":{start:{line:35,column:8},end:{line:60,column:11}},"17":{start:{line:36,column:12},end:{line:59,column:13}},"18":{start:{line:37,column:39},end:{line:46,column:18}},"19":{start:{line:45,column:20},end:{line:45,column:77}},"20":{start:{line:48,column:16},end:{line:54,column:19}},"21":{start:{line:49,column:20},end:{line:49,column:35}},"22":{start:{line:50,column:20},end:{line:50,column:46}},"23":{start:{line:52,column:20},end:{line:52,column:35}},"24":{start:{line:53,column:20},end:{line:53,column:72}},"25":{start:{line:57,column:17},end:{line:59,column:13}},"26":{start:{line:58,column:16},end:{line:58,column:92}},"27":{start:{line:64,column:8},end:{line:64,column:52}},"28":{start:{line:70,column:0},end:{line:89,column:2}},"29":{start:{line:71,column:16},end:{line:71,column:36}},"30":{start:{line:72,column:4},end:{line:75,column:5}},"31":{start:{line:74,column:8},end:{line:74,column:78}},"32":{start:{line:76,column:4},end:{line:88,column:6}},"33":{start:{line:77,column:8},end:{line:79,column:9}},"34":{start:{line:78,column:12},end:{line:78,column:35}},"35":{start:{line:80,column:8},end:{line:85,column:10}},"36":{start:{line:82,column:12},end:{line:82,column:45}},"37":{start:{line:84,column:12},end:{line:84,column:35}},"38":{start:{line:87,column:8},end:{line:87,column:31}},"39":{start:{line:94,column:0},end:{line:119,column:3}},"40":{start:{line:95,column:16},end:{line:95,column:36}},"41":{start:{line:96,column:4},end:{line:118,column:6}},"42":{start:{line:97,column:8},end:{line:99,column:9}},"43":{start:{line:98,column:12},end:{line:98,column:36}},"44":{start:{line:100,column:16},end:{line:100,column:24}},"45":{start:{line:101,column:4},end:{line:103,column:5}},"46":{start:{line:102,column:8},end:{line:102,column:71}},"47":{start:{line:104,column:21},end:{line:104,column:42}},"48":{start:{line:105,column:4},end:{line:115,column:6}},"49":{start:{line:106,column:8},end:{line:109,column:9}},"50":{start:{line:108,column:12},end:{line:108,column:71}},"51":{start:{line:111,column:8},end:{line:111,column:62}},"52":{start:{line:114,column:8},end:{line:114,column:58}},"53":{start:{line:117,column:8},end:{line:117,column:52}},"54":{start:{line:123,column:0},end:{line:179,column:3}},"55":{start:{line:124,column:16},end:{line:124,column:36}},"56":{start:{line:125,column:4},end:{line:178,column:6}},"57":{start:{line:126,column:8},end:{line:128,column:9}},"58":{start:{line:127,column:12},end:{line:127,column:36}},"59":{start:{line:129,column:16},end:{line:129,column:24}},"60":{start:{line:130,column:4},end:{line:132,column:5}},"61":{start:{line:131,column:8},end:{line:131,column:98}},"62":{start:{line:133,column:4},end:{line:135,column:5}},"63":{start:{line:134,column:8},end:{line:134,column:81}},"64":{start:{line:136,column:17},end:{line:136,column:33}},"65":{start:{line:137,column:4},end:{line:139,column:5}},"66":{start:{line:138,column:8},end:{line:138,column:56}},"67":{start:{line:141,column:21},end:{line:141,column:42}},"68":{start:{line:142,column:4},end:{line:175,column:6}},"69":{start:{line:143,column:8},end:{line:146,column:9}},"70":{start:{line:145,column:12},end:{line:145,column:62}},"71":{start:{line:148,column:8},end:{line:171,column:11}},"72":{start:{line:149,column:12},end:{line:169,column:13}},"73":{start:{line:150,column:16},end:{line:150,column:76}},"74":{start:{line:153,column:31},end:{line:153,column:47}},"75":{start:{line:154,column:16},end:{line:162,column:17}},"76":{start:{line:154,column:30},end:{line:154,column:31}},"77":{start:{line:155,column:20},end:{line:161,column:21}},"78":{start:{line:156,column:38},end:{line:156,column:54}},"79":{start:{line:157,column:24},end:{line:159,column:25}},"80":{start:{line:157,column:40},end:{line:157,column:45}},"81":{start:{line:158,column:28},end:{line:158,column:65}},"82":{start:{line:160,column:23},end:{line:160,column:39}},"83":{start:{line:163,column:16},end:{line:166,column:19}},"84":{start:{line:167,column:16},end:{line:167,column:84}},"85":{start:{line:174,column:8},end:{line:174,column:77}},"86":{start:{line:177,column:8},end:{line:177,column:52}},"87":{start:{line:182,column:0},end:{line:205,column:3}},"88":{start:{line:183,column:16},end:{line:183,column:36}},"89":{start:{line:184,column:4},end:{line:204,column:6}},"90":{start:{line:185,column:8},end:{line:188,column:9}},"91":{start:{line:187,column:12},end:{line:187,column:36}},"92":{start:{line:189,column:16},end:{line:189,column:24}},"93":{start:{line:190,column:4},end:{line:192,column:5}},"94":{start:{line:191,column:8},end:{line:191,column:79}},"95":{start:{line:193,column:16},end:{line:193,column:37}},"96":{start:{line:194,column:4},end:{line:201,column:6}},"97":{start:{line:195,column:8},end:{line:197,column:9}},"98":{start:{line:196,column:12},end:{line:196,column:67}},"99":{start:{line:198,column:8},end:{line:198,column:44}},"100":{start:{line:200,column:8},end:{line:200,column:57}},"101":{start:{line:203,column:8},end:{line:203,column:52}},"102":{start:{line:209,column:0},end:{line:209,column:22}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:19,column:25},end:{line:19,column:26}},loc:{start:{line:19,column:36},end:{line:66,column:1}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:33},end:{line:22,column:34}},loc:{start:{line:22,column:41},end:{line:63,column:5}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:35,column:92},end:{line:35,column:93}},loc:{start:{line:35,column:107},end:{line:60,column:9}},line:35},"3":{name:"(anonymous_3)",decl:{start:{line:44,column:18},end:{line:44,column:19}},loc:{start:{line:44,column:23},end:{line:46,column:17}},line:44},"4":{name:"(anonymous_4)",decl:{start:{line:48,column:45},end:{line:48,column:46}},loc:{start:{line:48,column:52},end:{line:51,column:17}},line:48},"5":{name:"(anonymous_5)",decl:{start:{line:51,column:25},end:{line:51,column:26}},loc:{start:{line:51,column:30},end:{line:54,column:17}},line:51},"6":{name:"(anonymous_6)",decl:{start:{line:63,column:13},end:{line:63,column:14}},loc:{start:{line:63,column:18},end:{line:65,column:5}},line:63},"7":{name:"(anonymous_7)",decl:{start:{line:70,column:27},end:{line:70,column:28}},loc:{start:{line:70,column:40},end:{line:89,column:1}},line:70},"8":{name:"(anonymous_8)",decl:{start:{line:76,column:33},end:{line:76,column:34}},loc:{start:{line:76,column:43},end:{line:86,column:5}},line:76},"9":{name:"(anonymous_9)",decl:{start:{line:80,column:46},end:{line:80,column:47}},loc:{start:{line:81,column:8},end:{line:83,column:9}},line:81},"10":{name:"(anonymous_10)",decl:{start:{line:83,column:17},end:{line:83,column:18}},loc:{start:{line:83,column:24},end:{line:85,column:9}},line:83},"11":{name:"(anonymous_11)",decl:{start:{line:86,column:13},end:{line:86,column:14}},loc:{start:{line:86,column:20},end:{line:88,column:5}},line:86},"12":{name:"(anonymous_12)",decl:{start:{line:94,column:27},end:{line:94,column:28}},loc:{start:{line:94,column:38},end:{line:119,column:1}},line:94},"13":{name:"(anonymous_13)",decl:{start:{line:96,column:33},end:{line:96,column:34}},loc:{start:{line:96,column:41},end:{line:116,column:5}},line:96},"14":{name:"(anonymous_14)",decl:{start:{line:105,column:91},end:{line:105,column:92}},loc:{start:{line:105,column:106},end:{line:113,column:5}},line:105},"15":{name:"(anonymous_15)",decl:{start:{line:113,column:13},end:{line:113,column:14}},loc:{start:{line:113,column:18},end:{line:115,column:5}},line:113},"16":{name:"(anonymous_16)",decl:{start:{line:116,column:13},end:{line:116,column:14}},loc:{start:{line:116,column:18},end:{line:118,column:5}},line:116},"17":{name:"(anonymous_17)",decl:{start:{line:123,column:34},end:{line:123,column:35}},loc:{start:{line:123,column:45},end:{line:179,column:1}},line:123},"18":{name:"(anonymous_18)",decl:{start:{line:125,column:33},end:{line:125,column:34}},loc:{start:{line:125,column:41},end:{line:176,column:5}},line:125},"19":{name:"(anonymous_19)",decl:{start:{line:142,column:82},end:{line:142,column:83}},loc:{start:{line:142,column:97},end:{line:173,column:5}},line:142},"20":{name:"(anonymous_20)",decl:{start:{line:148,column:92},end:{line:148,column:93}},loc:{start:{line:148,column:105},end:{line:171,column:9}},line:148},"21":{name:"(anonymous_21)",decl:{start:{line:163,column:135},end:{line:163,column:136}},loc:{start:{line:163,column:142},end:{line:166,column:17}},line:163},"22":{name:"(anonymous_22)",decl:{start:{line:173,column:13},end:{line:173,column:14}},loc:{start:{line:173,column:18},end:{line:175,column:5}},line:173},"23":{name:"(anonymous_23)",decl:{start:{line:176,column:13},end:{line:176,column:14}},loc:{start:{line:176,column:18},end:{line:178,column:5}},line:176},"24":{name:"(anonymous_24)",decl:{start:{line:182,column:30},end:{line:182,column:31}},loc:{start:{line:182,column:41},end:{line:205,column:1}},line:182},"25":{name:"(anonymous_25)",decl:{start:{line:184,column:33},end:{line:184,column:34}},loc:{start:{line:184,column:41},end:{line:202,column:5}},line:184},"26":{name:"(anonymous_26)",decl:{start:{line:194,column:74},end:{line:194,column:75}},loc:{start:{line:194,column:85},end:{line:199,column:5}},line:194},"27":{name:"(anonymous_27)",decl:{start:{line:199,column:13},end:{line:199,column:14}},loc:{start:{line:199,column:18},end:{line:201,column:5}},line:199},"28":{name:"(anonymous_28)",decl:{start:{line:202,column:13},end:{line:202,column:14}},loc:{start:{line:202,column:18},end:{line:204,column:5}},line:202}},branchMap:{"0":{loc:{start:{line:23,column:8},end:{line:25,column:9}},type:"if",locations:[{start:{line:23,column:8},end:{line:25,column:9}},{start:{line:23,column:8},end:{line:25,column:9}}],line:23},"1":{loc:{start:{line:26,column:8},end:{line:28,column:9}},type:"if",locations:[{start:{line:26,column:8},end:{line:28,column:9}},{start:{line:26,column:8},end:{line:28,column:9}}],line:26},"2":{loc:{start:{line:36,column:12},end:{line:59,column:13}},type:"if",locations:[{start:{line:36,column:12},end:{line:59,column:13}},{start:{line:36,column:12},end:{line:59,column:13}}],line:36},"3":{loc:{start:{line:57,column:17},end:{line:59,column:13}},type:"if",locations:[{start:{line:57,column:17},end:{line:59,column:13}},{start:{line:57,column:17},end:{line:59,column:13}}],line:57},"4":{loc:{start:{line:72,column:4},end:{line:75,column:5}},type:"if",locations:[{start:{line:72,column:4},end:{line:75,column:5}},{start:{line:72,column:4},end:{line:75,column:5}}],line:72},"5":{loc:{start:{line:77,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:77,column:8},end:{line:79,column:9}},{start:{line:77,column:8},end:{line:79,column:9}}],line:77},"6":{loc:{start:{line:97,column:8},end:{line:99,column:9}},type:"if",locations:[{start:{line:97,column:8},end:{line:99,column:9}},{start:{line:97,column:8},end:{line:99,column:9}}],line:97},"7":{loc:{start:{line:101,column:4},end:{line:103,column:5}},type:"if",locations:[{start:{line:101,column:4},end:{line:103,column:5}},{start:{line:101,column:4},end:{line:103,column:5}}],line:101},"8":{loc:{start:{line:106,column:8},end:{line:109,column:9}},type:"if",locations:[{start:{line:106,column:8},end:{line:109,column:9}},{start:{line:106,column:8},end:{line:109,column:9}}],line:106},"9":{loc:{start:{line:126,column:8},end:{line:128,column:9}},type:"if",locations:[{start:{line:126,column:8},end:{line:128,column:9}},{start:{line:126,column:8},end:{line:128,column:9}}],line:126},"10":{loc:{start:{line:130,column:4},end:{line:132,column:5}},type:"if",locations:[{start:{line:130,column:4},end:{line:132,column:5}},{start:{line:130,column:4},end:{line:132,column:5}}],line:130},"11":{loc:{start:{line:133,column:4},end:{line:135,column:5}},type:"if",locations:[{start:{line:133,column:4},end:{line:135,column:5}},{start:{line:133,column:4},end:{line:135,column:5}}],line:133},"12":{loc:{start:{line:137,column:4},end:{line:139,column:5}},type:"if",locations:[{start:{line:137,column:4},end:{line:139,column:5}},{start:{line:137,column:4},end:{line:139,column:5}}],line:137},"13":{loc:{start:{line:143,column:8},end:{line:146,column:9}},type:"if",locations:[{start:{line:143,column:8},end:{line:146,column:9}},{start:{line:143,column:8},end:{line:146,column:9}}],line:143},"14":{loc:{start:{line:149,column:12},end:{line:169,column:13}},type:"if",locations:[{start:{line:149,column:12},end:{line:169,column:13}},{start:{line:149,column:12},end:{line:169,column:13}}],line:149},"15":{loc:{start:{line:155,column:20},end:{line:161,column:21}},type:"if",locations:[{start:{line:155,column:20},end:{line:161,column:21}},{start:{line:155,column:20},end:{line:161,column:21}}],line:155},"16":{loc:{start:{line:185,column:8},end:{line:188,column:9}},type:"if",locations:[{start:{line:185,column:8},end:{line:188,column:9}},{start:{line:185,column:8},end:{line:188,column:9}}],line:185},"17":{loc:{start:{line:190,column:4},end:{line:192,column:5}},type:"if",locations:[{start:{line:190,column:4},end:{line:192,column:5}},{start:{line:190,column:4},end:{line:192,column:5}}],line:190},"18":{loc:{start:{line:195,column:8},end:{line:197,column:9}},type:"if",locations:[{start:{line:195,column:8},end:{line:197,column:9}},{start:{line:195,column:8},end:{line:197,column:9}}],line:195}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2c9f12c2bd99c5832c9e725ca6445ae14a221705"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1x1z8irhkk=function(){return actualCoverage;};return actualCoverage;}cov_1x1z8irhkk();const express=(cov_1x1z8irhkk().s[0]++,require('express'));var{mongoose}=(cov_1x1z8irhkk().s[1]++,require("../db/mongoose.js"));const{track}=(cov_1x1z8irhkk().s[2]++,require("../models/track"));var{playlist}=(cov_1x1z8irhkk().s[3]++,require("../models/playlists.js"));var{User}=(cov_1x1z8irhkk().s[4]++,require("../models/users.js"));var{images}=(cov_1x1z8irhkk().s[5]++,require("./../models/images.js"));// images model
const{ObjectID}=(cov_1x1z8irhkk().s[6]++,require('mongodb'));const router=(cov_1x1z8irhkk().s[7]++,express.Router());//app.listen(3000,()=>{console.log('started on port 3000');});
//CREATE A NEW PLAYLIST
cov_1x1z8irhkk().s[8]++;router.post('/playlists',(req,res)=>{cov_1x1z8irhkk().f[0]++;var token=(cov_1x1z8irhkk().s[9]++,req.header('x-auth'));cov_1x1z8irhkk().s[10]++;User.findByToken(token).then(user=>{cov_1x1z8irhkk().f[1]++;cov_1x1z8irhkk().s[11]++;if(!user){cov_1x1z8irhkk().b[0][0]++;cov_1x1z8irhkk().s[12]++;return Promise.reject();}else{cov_1x1z8irhkk().b[0][1]++;}cov_1x1z8irhkk().s[13]++;if(!req.body.playlistName){cov_1x1z8irhkk().b[1][0]++;cov_1x1z8irhkk().s[14]++;return res.status(400).send("Playlist must have a name");}else{cov_1x1z8irhkk().b[1][1]++;}//PREVENT THE USER FROM HAVING 2 PLAYLISTS WITH THE SAME NAME
var userId2=(cov_1x1z8irhkk().s[15]++,user._id);cov_1x1z8irhkk().s[16]++;playlist.find({$and:[{userId:userId2},{playlistName:req.body.playlistName}]}).then(myduplicate=>{cov_1x1z8irhkk().f[2]++;cov_1x1z8irhkk().s[17]++;if(myduplicate.length==0){cov_1x1z8irhkk().b[2][0]++;var playlistInstance=(cov_1x1z8irhkk().s[18]++,new playlist({userId:userId2,playlistName:req.body.playlistName,privacy:req.body.privacy// href:playlistInstance.href         // to be uncommented when href is known
},e=>{cov_1x1z8irhkk().f[3]++;cov_1x1z8irhkk().s[19]++;return res.status(500).send("Coult not create playlist");}));cov_1x1z8irhkk().s[20]++;playlistInstance.save().then(doc=>{cov_1x1z8irhkk().f[4]++;cov_1x1z8irhkk().s[21]++;myduplicate=[];cov_1x1z8irhkk().s[22]++;res.status(201).send(doc);}).catch(e=>{cov_1x1z8irhkk().f[5]++;cov_1x1z8irhkk().s[23]++;myduplicate=[];cov_1x1z8irhkk().s[24]++;res.status(500).send("Could not save the playlist");});}else{cov_1x1z8irhkk().b[2][1]++;cov_1x1z8irhkk().s[25]++;if(myduplicate.length!=0){cov_1x1z8irhkk().b[3][0]++;cov_1x1z8irhkk().s[26]++;return res.status(400).send("Cannot create 2 playlists with the same name");}else{cov_1x1z8irhkk().b[3][1]++;}};});}).catch(e=>{cov_1x1z8irhkk().f[6]++;cov_1x1z8irhkk().s[27]++;res.status(401).send('Unauthorized Access');});});//Get a User Playlist Request
cov_1x1z8irhkk().s[28]++;router.get('/playlists/me',(req,res)=>{cov_1x1z8irhkk().f[7]++;var token=(cov_1x1z8irhkk().s[29]++,req.header('x-auth'));cov_1x1z8irhkk().s[30]++;if(!token){cov_1x1z8irhkk().b[4][0]++;cov_1x1z8irhkk().s[31]++;res.status(400).send('You should Pass a token to access the profile');}else{cov_1x1z8irhkk().b[4][1]++;}cov_1x1z8irhkk().s[32]++;User.findByToken(token).then(user=>{cov_1x1z8irhkk().f[8]++;cov_1x1z8irhkk().s[33]++;if(!user){cov_1x1z8irhkk().b[5][0]++;cov_1x1z8irhkk().s[34]++;res.status(401).send();}else{cov_1x1z8irhkk().b[5][1]++;}cov_1x1z8irhkk().s[35]++;playlist.find({userId:user._id}).then(playlist=>{cov_1x1z8irhkk().f[9]++;cov_1x1z8irhkk().s[36]++;res.status(302).send({playlist});}).catch(e=>{cov_1x1z8irhkk().f[10]++;cov_1x1z8irhkk().s[37]++;res.status(401).send();});}).catch(e=>{cov_1x1z8irhkk().f[11]++;cov_1x1z8irhkk().s[38]++;res.status(401).send();});});//DELETE A PLAYLIST
cov_1x1z8irhkk().s[39]++;router.delete('/playlists',(req,res)=>{cov_1x1z8irhkk().f[12]++;var token=(cov_1x1z8irhkk().s[40]++,req.header('x-auth'));cov_1x1z8irhkk().s[41]++;User.findByToken(token).then(user=>{cov_1x1z8irhkk().f[13]++;cov_1x1z8irhkk().s[42]++;if(!user){cov_1x1z8irhkk().b[6][0]++;cov_1x1z8irhkk().s[43]++;return Promise.reject();}else{cov_1x1z8irhkk().b[6][1]++;}var userId2=(cov_1x1z8irhkk().s[44]++,user._id);// id of the owner of the playlist 
cov_1x1z8irhkk().s[45]++;if(!req.body.playlistName){cov_1x1z8irhkk().b[7][0]++;cov_1x1z8irhkk().s[46]++;return res.status(400).send("Pass the playlistname to delete");}else{cov_1x1z8irhkk().b[7][1]++;}var playlistName=(cov_1x1z8irhkk().s[47]++,req.body.playlistName);cov_1x1z8irhkk().s[48]++;playlist.findOneAndRemove({$and:[{userId:userId2},{playlistName:playlistName}]}).then(delPlaylist=>{cov_1x1z8irhkk().f[14]++;cov_1x1z8irhkk().s[49]++;if(!delPlaylist){cov_1x1z8irhkk().b[8][0]++;cov_1x1z8irhkk().s[50]++;return res.status(404).send('No playlist found to delete');}else{cov_1x1z8irhkk().b[8][1]++;}cov_1x1z8irhkk().s[51]++;res.status(200).send("Playlist deleted succsesfully");}).catch(e=>{cov_1x1z8irhkk().f[15]++;cov_1x1z8irhkk().s[52]++;res.status(500).send("Could not delete playlist");});}).catch(e=>{cov_1x1z8irhkk().f[16]++;cov_1x1z8irhkk().s[53]++;res.status(401).send('Unauthorized Access');});});//DELETE TRACKS FROM A PLAYLIST
cov_1x1z8irhkk().s[54]++;router.delete('/playlists/tracks',(req,res)=>{cov_1x1z8irhkk().f[17]++;var token=(cov_1x1z8irhkk().s[55]++,req.header('x-auth'));cov_1x1z8irhkk().s[56]++;User.findByToken(token).then(user=>{cov_1x1z8irhkk().f[18]++;cov_1x1z8irhkk().s[57]++;if(!user){cov_1x1z8irhkk().b[9][0]++;cov_1x1z8irhkk().s[58]++;return Promise.reject();}else{cov_1x1z8irhkk().b[9][1]++;}var userId2=(cov_1x1z8irhkk().s[59]++,user._id);// id of the owner of the playlist 
cov_1x1z8irhkk().s[60]++;if(!req.body.playlistName){cov_1x1z8irhkk().b[10][0]++;cov_1x1z8irhkk().s[61]++;return res.status(400).send("Pass the playlistname that you want to delete a track from");}else{cov_1x1z8irhkk().b[10][1]++;}cov_1x1z8irhkk().s[62]++;if(!req.body.trackId){cov_1x1z8irhkk().b[11][0]++;cov_1x1z8irhkk().s[63]++;return res.status(400).send("Pass the track id that you want to delete");}else{cov_1x1z8irhkk().b[11][1]++;}var trackId=(cov_1x1z8irhkk().s[64]++,req.body.trackId);cov_1x1z8irhkk().s[65]++;if(!ObjectID.isValid(trackId)){cov_1x1z8irhkk().b[12][0]++;cov_1x1z8irhkk().s[66]++;return res.status(404).send("Invalid Track Id");}else{cov_1x1z8irhkk().b[12][1]++;}var playlistName=(cov_1x1z8irhkk().s[67]++,req.body.playlistName);cov_1x1z8irhkk().s[68]++;playlist.findOne({$and:[{userId:userId2},{playlistName:playlistName}]}).then(delPlaylist=>{cov_1x1z8irhkk().f[19]++;cov_1x1z8irhkk().s[69]++;if(!delPlaylist){cov_1x1z8irhkk().b[13][0]++;cov_1x1z8irhkk().s[70]++;return res.status(404).send('Playlist not found');}else{cov_1x1z8irhkk().b[13][1]++;}cov_1x1z8irhkk().s[71]++;playlist.findOne({$and:[{tracks:{$eq:trackId}},{playlistName:playlistName}]}).then(delTrack1=>{cov_1x1z8irhkk().f[20]++;cov_1x1z8irhkk().s[72]++;if(!delTrack1){cov_1x1z8irhkk().b[14][0]++;cov_1x1z8irhkk().s[73]++;return res.status(400).send("Track is not in the playlist");}else{cov_1x1z8irhkk().b[14][1]++;var tracksarr=(cov_1x1z8irhkk().s[74]++,delTrack1.tracks);cov_1x1z8irhkk().s[75]++;for(var count=(cov_1x1z8irhkk().s[76]++,0);count<tracksarr.length;count++){cov_1x1z8irhkk().s[77]++;if(tracksarr[count]==trackId){cov_1x1z8irhkk().b[15][0]++;var temptrack=(cov_1x1z8irhkk().s[78]++,tracksarr[count]);cov_1x1z8irhkk().s[79]++;for(var count2=(cov_1x1z8irhkk().s[80]++,count);count2<tracksarr.length-1;count2++){cov_1x1z8irhkk().s[81]++;tracksarr[count2]=tracksarr[count2+1];}cov_1x1z8irhkk().s[82]++;tracksarr.pop();}else{cov_1x1z8irhkk().b[15][1]++;}}cov_1x1z8irhkk().s[83]++;playlist.findOneAndUpdate({$and:[{userId:userId2},{playlistName:playlistName}]},{$set:{tracks:tracksarr}}).then(res=>{cov_1x1z8irhkk().f[21]++;});cov_1x1z8irhkk().s[84]++;res.status(200).send("Track is successfully deleted from playlist");}});}).catch(e=>{cov_1x1z8irhkk().f[22]++;cov_1x1z8irhkk().s[85]++;res.status(500).send("Could not remove the track from the playlist");});}).catch(e=>{cov_1x1z8irhkk().f[23]++;cov_1x1z8irhkk().s[86]++;res.status(401).send('Unauthorized Access');});});//GET PLAYLIST COVER IMAGE
cov_1x1z8irhkk().s[87]++;router.get('/playlists/image',(req,res)=>{cov_1x1z8irhkk().f[24]++;var token=(cov_1x1z8irhkk().s[88]++,req.header('x-auth'));cov_1x1z8irhkk().s[89]++;User.findByToken(token).then(user=>{cov_1x1z8irhkk().f[25]++;cov_1x1z8irhkk().s[90]++;if(!user){cov_1x1z8irhkk().b[16][0]++;cov_1x1z8irhkk().s[91]++;return Promise.reject();}else{cov_1x1z8irhkk().b[16][1]++;}var userId2=(cov_1x1z8irhkk().s[92]++,user._id);cov_1x1z8irhkk().s[93]++;if(!req.body.playlistName){cov_1x1z8irhkk().b[17][0]++;cov_1x1z8irhkk().s[94]++;return res.status(400).send("Pass the playlistname to get it's image");}else{cov_1x1z8irhkk().b[17][1]++;}var pName=(cov_1x1z8irhkk().s[95]++,req.body.playlistName);cov_1x1z8irhkk().s[96]++;playlist.findOne({$and:[{userId:userId2},{playlistName:pName}]}).then(fetched=>{cov_1x1z8irhkk().f[26]++;cov_1x1z8irhkk().s[97]++;if(!fetched){cov_1x1z8irhkk().b[18][0]++;cov_1x1z8irhkk().s[98]++;return res.status(404).send('Playlist does not exist');}else{cov_1x1z8irhkk().b[18][1]++;}cov_1x1z8irhkk().s[99]++;res.status(302).send(fetched.image);}).catch(e=>{cov_1x1z8irhkk().f[27]++;cov_1x1z8irhkk().s[100]++;res.status(500).send("Could not send the image");});}).catch(e=>{cov_1x1z8irhkk().f[28]++;cov_1x1z8irhkk().s[101]++;res.status(401).send('Unauthorized Access');});});cov_1x1z8irhkk().s[102]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBsYXlsaXN0Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwidHJhY2siLCJwbGF5bGlzdCIsIlVzZXIiLCJpbWFnZXMiLCJPYmplY3RJRCIsInJvdXRlciIsIlJvdXRlciIsInBvc3QiLCJyZXEiLCJyZXMiLCJ0b2tlbiIsImhlYWRlciIsImZpbmRCeVRva2VuIiwidGhlbiIsInVzZXIiLCJQcm9taXNlIiwicmVqZWN0IiwiYm9keSIsInBsYXlsaXN0TmFtZSIsInN0YXR1cyIsInNlbmQiLCJ1c2VySWQyIiwiX2lkIiwiZmluZCIsIiRhbmQiLCJ1c2VySWQiLCJteWR1cGxpY2F0ZSIsImxlbmd0aCIsInBsYXlsaXN0SW5zdGFuY2UiLCJwcml2YWN5IiwiZSIsInNhdmUiLCJkb2MiLCJjYXRjaCIsImdldCIsImRlbGV0ZSIsImZpbmRPbmVBbmRSZW1vdmUiLCJkZWxQbGF5bGlzdCIsInRyYWNrSWQiLCJpc1ZhbGlkIiwiZmluZE9uZSIsInRyYWNrcyIsIiRlcSIsImRlbFRyYWNrMSIsInRyYWNrc2FyciIsImNvdW50IiwidGVtcHRyYWNrIiwiY291bnQyIiwicG9wIiwiZmluZE9uZUFuZFVwZGF0ZSIsIiRzZXQiLCJwTmFtZSIsImZldGNoZWQiLCJpbWFnZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJxOWVBQUEsS0FBTUEsQ0FBQUEsT0FBTywwQkFBQ0MsT0FBTyxDQUFDLFNBQUQsQ0FBUixDQUFiLENBQ0EsR0FBSSxDQUFFQyxRQUFGLDJCQUFlRCxPQUFPLENBQUMsbUJBQUQsQ0FBdEIsQ0FBSixDQUNBLEtBQUssQ0FBQ0UsS0FBRCwyQkFBUUYsT0FBTyxDQUFDLGlCQUFELENBQWYsQ0FBTCxDQUNBLEdBQUksQ0FBQ0csUUFBRCwyQkFBYUgsT0FBTyxDQUFDLHdCQUFELENBQXBCLENBQUosQ0FDQSxHQUFJLENBQUNJLElBQUQsMkJBQVNKLE9BQU8sQ0FBQyxvQkFBRCxDQUFoQixDQUFK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QUcsQ0FBQ1UsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLDBCQUFyQixFQUNILENBUEQsRUFRQyxDQWxCRCxFQWtCR2EsS0FsQkgsQ0FrQlVILENBQUQsRUFBSyxvREFDVnJCLEdBQUcsQ0FBQ1UsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLHFCQUFyQixFQUNILENBcEJELEVBcUJILENBdkJELEUsMEJBMkJBa0MsTUFBTSxDQUFDQyxPQUFQLENBQWVsRCxNQUFmIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcz1yZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciB7IG1vbmdvb3NlIH0gPSByZXF1aXJlKFwiLi4vZGIvbW9uZ29vc2UuanNcIik7XHJcbmNvbnN0e3RyYWNrfT1yZXF1aXJlKFwiLi4vbW9kZWxzL3RyYWNrXCIpO1xyXG52YXIge3BsYXlsaXN0fSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvcGxheWxpc3RzLmpzXCIpO1xyXG52YXIge1VzZXJ9ID0gcmVxdWlyZShcIi4uL21vZGVscy91c2Vycy5qc1wiKTtcclxuXHJcbnZhcntpbWFnZXN9PSByZXF1aXJlKFwiLi8uLi9tb2RlbHMvaW1hZ2VzLmpzXCIpOyAvLyBpbWFnZXMgbW9kZWxcclxuXHJcbmNvbnN0IHtPYmplY3RJRH09cmVxdWlyZSgnbW9uZ29kYicpO1xyXG5cclxuY29uc3Qgcm91dGVyPWV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG5cclxuXHJcbi8vYXBwLmxpc3RlbigzMDAwLCgpPT57Y29uc29sZS5sb2coJ3N0YXJ0ZWQgb24gcG9ydCAzMDAwJyk7fSk7XHJcblxyXG5cclxuLy9DUkVBVEUgQSBORVcgUExBWUxJU1Rcclxucm91dGVyLnBvc3QoJy9wbGF5bGlzdHMnLChyZXEscmVzKT0+e1xyXG4gICAgXHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIFVzZXIuZmluZEJ5VG9rZW4odG9rZW4pLnRoZW4oKHVzZXIpPT57XHJcbiAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIXJlcS5ib2R5LnBsYXlsaXN0TmFtZSl7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlBsYXlsaXN0IG11c3QgaGF2ZSBhIG5hbWVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxuXHJcbiAgICAgICAgLy9QUkVWRU5UIFRIRSBVU0VSIEZST00gSEFWSU5HIDIgUExBWUxJU1RTIFdJVEggVEhFIFNBTUUgTkFNRVxyXG5cclxuICAgICAgICB2YXIgdXNlcklkMj11c2VyLl9pZDtcclxuICAgICAgICBwbGF5bGlzdC5maW5kKHskYW5kOlt7dXNlcklkOnVzZXJJZDJ9LHtwbGF5bGlzdE5hbWU6cmVxLmJvZHkucGxheWxpc3ROYW1lIH1dfSkudGhlbigobXlkdXBsaWNhdGUpPT57XHJcbiAgICAgICAgICAgIGlmKG15ZHVwbGljYXRlLmxlbmd0aD09MCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGxheWxpc3RJbnN0YW5jZSA9IG5ldyBwbGF5bGlzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOnVzZXJJZDIsICAgICBcclxuICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdE5hbWU6IHJlcS5ib2R5LnBsYXlsaXN0TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBwcml2YWN5OiByZXEuYm9keS5wcml2YWN5LFxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgLy8gaHJlZjpwbGF5bGlzdEluc3RhbmNlLmhyZWYgICAgICAgICAvLyB0byBiZSB1bmNvbW1lbnRlZCB3aGVuIGhyZWYgaXMga25vd25cclxuICAgICAgICAgICAgICAgIH0sKGUpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKFwiQ291bHQgbm90IGNyZWF0ZSBwbGF5bGlzdFwiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHBsYXlsaXN0SW5zdGFuY2Uuc2F2ZSgpLnRoZW4oKGRvYyk9PntcclxuICAgICAgICAgICAgICAgICAgICBteWR1cGxpY2F0ZT1bXTtcclxuICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuc2VuZChkb2MpOyAgXHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZSk9PntcclxuICAgICAgICAgICAgICAgICAgICBteWR1cGxpY2F0ZT1bXTtcclxuICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChcIkNvdWxkIG5vdCBzYXZlIHRoZSBwbGF5bGlzdFwiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihteWR1cGxpY2F0ZS5sZW5ndGghPTApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiQ2Fubm90IGNyZWF0ZSAyIHBsYXlsaXN0cyB3aXRoIHRoZSBzYW1lIG5hbWVcIik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgXHJcbiAgICB9KS5jYXRjaCgoZSk9PntcclxuICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnVW5hdXRob3JpemVkIEFjY2VzcycpO1xyXG4gICAgfSlcclxufSk7XHJcblxyXG5cclxuLy9HZXQgYSBVc2VyIFBsYXlsaXN0IFJlcXVlc3Rcclxucm91dGVyLmdldCgnL3BsYXlsaXN0cy9tZScsKHJlcSxyZXMpID0+IHtcclxuICAgIHZhciB0b2tlbiA9IHJlcS5oZWFkZXIoJ3gtYXV0aCcpO1xyXG4gICAgaWYoIXRva2VuKVxyXG4gICAge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKCdZb3Ugc2hvdWxkIFBhc3MgYSB0b2tlbiB0byBhY2Nlc3MgdGhlIHByb2ZpbGUnKTtcclxuICAgIH1cclxuICAgIFVzZXIuZmluZEJ5VG9rZW4odG9rZW4pLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgICBpZighdXNlcil7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBsYXlsaXN0LmZpbmQoe3VzZXJJZDp1c2VyLl9pZH0pLnRoZW4oKHBsYXlsaXN0KSA9PlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cygzMDIpLnNlbmQoe3BsYXlsaXN0fSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKGUpID0+IHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoKTtcclxuICAgICAgICB9KVxyXG4gICAgfSkuY2F0Y2goKGUpID0+IHtcclxuICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgpO1xyXG4gICAgfSlcclxufSkgICAgXHJcblxyXG5cclxuXHJcbi8vREVMRVRFIEEgUExBWUxJU1Rcclxucm91dGVyLmRlbGV0ZSgnL3BsYXlsaXN0cycsKHJlcSxyZXMpPT57XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIFVzZXIuZmluZEJ5VG9rZW4odG9rZW4pLnRoZW4oKHVzZXIpPT57XHJcbiAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcbiAgICB2YXIgdXNlcklkMj11c2VyLl9pZDsgICAgIC8vIGlkIG9mIHRoZSBvd25lciBvZiB0aGUgcGxheWxpc3QgXHJcbiAgICBpZighcmVxLmJvZHkucGxheWxpc3ROYW1lKXtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJQYXNzIHRoZSBwbGF5bGlzdG5hbWUgdG8gZGVsZXRlXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIHBsYXlsaXN0TmFtZT1yZXEuYm9keS5wbGF5bGlzdE5hbWU7XHJcbiAgICBwbGF5bGlzdC5maW5kT25lQW5kUmVtb3ZlKHskYW5kOlt7dXNlcklkOnVzZXJJZDJ9LHtwbGF5bGlzdE5hbWU6cGxheWxpc3ROYW1lIH1dfSkudGhlbigoZGVsUGxheWxpc3QpPT57XHJcbiAgICAgICAgaWYoIWRlbFBsYXlsaXN0KXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCgnTm8gcGxheWxpc3QgZm91bmQgdG8gZGVsZXRlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKFwiUGxheWxpc3QgZGVsZXRlZCBzdWNjc2VzZnVsbHlcIik7XHJcblxyXG4gICAgfSkuY2F0Y2goKGUpPT57XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoXCJDb3VsZCBub3QgZGVsZXRlIHBsYXlsaXN0XCIpO1xyXG4gICAgfSlcclxuICAgIH0pLmNhdGNoKChlKT0+e1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCdVbmF1dGhvcml6ZWQgQWNjZXNzJyk7XHJcbiAgICB9KVxyXG59KTtcclxuXHJcblxyXG4vL0RFTEVURSBUUkFDS1MgRlJPTSBBIFBMQVlMSVNUXHJcbnJvdXRlci5kZWxldGUoJy9wbGF5bGlzdHMvdHJhY2tzJywocmVxLHJlcyk9PntcclxuICAgIHZhciB0b2tlbiA9IHJlcS5oZWFkZXIoJ3gtYXV0aCcpO1xyXG4gICAgVXNlci5maW5kQnlUb2tlbih0b2tlbikudGhlbigodXNlcik9PntcclxuICAgICAgICBpZighdXNlcil7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuICAgIHZhciB1c2VySWQyPXVzZXIuX2lkOyAgICAgLy8gaWQgb2YgdGhlIG93bmVyIG9mIHRoZSBwbGF5bGlzdCBcclxuICAgIGlmKCFyZXEuYm9keS5wbGF5bGlzdE5hbWUpe1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlBhc3MgdGhlIHBsYXlsaXN0bmFtZSB0aGF0IHlvdSB3YW50IHRvIGRlbGV0ZSBhIHRyYWNrIGZyb21cIik7XHJcbiAgICB9XHJcbiAgICBpZighcmVxLmJvZHkudHJhY2tJZCl7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiUGFzcyB0aGUgdHJhY2sgaWQgdGhhdCB5b3Ugd2FudCB0byBkZWxldGVcIik7XHJcbiAgICB9XHJcbiAgICB2YXIgdHJhY2tJZD0gcmVxLmJvZHkudHJhY2tJZFxyXG4gICAgaWYoIU9iamVjdElELmlzVmFsaWQodHJhY2tJZCkpe1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZChcIkludmFsaWQgVHJhY2sgSWRcIik7ICAgXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBsYXlsaXN0TmFtZT1yZXEuYm9keS5wbGF5bGlzdE5hbWU7XHJcbiAgICBwbGF5bGlzdC5maW5kT25lKHskYW5kOlt7dXNlcklkOnVzZXJJZDJ9LHtwbGF5bGlzdE5hbWU6cGxheWxpc3ROYW1lIH1dfSkudGhlbigoZGVsUGxheWxpc3QpPT57XHJcbiAgICAgICAgaWYoIWRlbFBsYXlsaXN0KXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCgnUGxheWxpc3Qgbm90IGZvdW5kJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHBsYXlsaXN0LmZpbmRPbmUoeyRhbmQ6W3t0cmFja3M6eyRlcTp0cmFja0lkfX0se3BsYXlsaXN0TmFtZTpwbGF5bGlzdE5hbWUgfV19KS50aGVuKChkZWxUcmFjazEpPT57XHJcbiAgICAgICAgICAgIGlmKCFkZWxUcmFjazEpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVHJhY2sgaXMgbm90IGluIHRoZSBwbGF5bGlzdFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdmFyIHRyYWNrc2Fycj0gZGVsVHJhY2sxLnRyYWNrcztcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgY291bnQ9MCA7IGNvdW50PHRyYWNrc2Fyci5sZW5ndGg7Y291bnQrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodHJhY2tzYXJyW2NvdW50XT09dHJhY2tJZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wdHJhY2s9dHJhY2tzYXJyW2NvdW50XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY291bnQyPWNvdW50IDsgY291bnQyPHRyYWNrc2Fyci5sZW5ndGgtMSA7IGNvdW50MisrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc2Fycltjb3VudDJdPXRyYWNrc2Fycltjb3VudDIrMV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc2Fyci5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwbGF5bGlzdC5maW5kT25lQW5kVXBkYXRlKHskYW5kOlt7dXNlcklkOnVzZXJJZDJ9LHtwbGF5bGlzdE5hbWU6cGxheWxpc3ROYW1lIH1dfSx7ICRzZXQ6IHsgdHJhY2tzOnRyYWNrc2FyciAgfSB9KS50aGVuKChyZXMpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKFwiVHJhY2sgaXMgc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgZnJvbSBwbGF5bGlzdFwiKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH0pLmNhdGNoKChlKT0+e1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKFwiQ291bGQgbm90IHJlbW92ZSB0aGUgdHJhY2sgZnJvbSB0aGUgcGxheWxpc3RcIik7XHJcbiAgICB9KVxyXG4gICAgfSkuY2F0Y2goKGUpPT57XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ1VuYXV0aG9yaXplZCBBY2Nlc3MnKTtcclxuICAgIH0pXHJcbn0pO1xyXG4vL0dFVCBQTEFZTElTVCBDT1ZFUiBJTUFHRVxyXG5cclxucm91dGVyLmdldCgnL3BsYXlsaXN0cy9pbWFnZScsKHJlcSxyZXMpPT57XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIFVzZXIuZmluZEJ5VG9rZW4odG9rZW4pLnRoZW4oKHVzZXIpPT57XHJcbiAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgdmFyIHVzZXJJZDI9dXNlci5faWQ7XHJcbiAgICBpZighcmVxLmJvZHkucGxheWxpc3ROYW1lKXtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJQYXNzIHRoZSBwbGF5bGlzdG5hbWUgdG8gZ2V0IGl0J3MgaW1hZ2VcIik7XHJcbiAgICB9XHJcbiAgICB2YXIgcE5hbWUgPSByZXEuYm9keS5wbGF5bGlzdE5hbWU7XHJcbiAgICBwbGF5bGlzdC5maW5kT25lKHskYW5kOlt7dXNlcklkOnVzZXJJZDJ9LHtwbGF5bGlzdE5hbWU6cE5hbWV9XX0pLnRoZW4oKGZldGNoZWQpPT57XHJcbiAgICAgICAgaWYoIWZldGNoZWQpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoJ1BsYXlsaXN0IGRvZXMgbm90IGV4aXN0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlcy5zdGF0dXMoMzAyKS5zZW5kKGZldGNoZWQuaW1hZ2UpO1xyXG4gICAgfSkuY2F0Y2goKGUpPT57XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoXCJDb3VsZCBub3Qgc2VuZCB0aGUgaW1hZ2VcIik7XHJcbiAgICB9KVxyXG4gICAgfSkuY2F0Y2goKGUpPT57XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ1VuYXV0aG9yaXplZCBBY2Nlc3MnKTtcclxuICAgIH0pXHJcbn0pO1xyXG5cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXI7XHJcbiJdfQ==