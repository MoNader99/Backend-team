function cov_2qg90no9yc(){var path="G:\\SWbackend\\Integrated\\Backend-team\\Services\\addtrack.js";var hash="8dee0617b5986fcd944816288af3424a0a993f6e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"G:\\SWbackend\\Integrated\\Backend-team\\Services\\addtrack.js",statementMap:{"0":{start:{line:2,column:15},end:{line:2,column:33}},"1":{start:{line:3,column:16},end:{line:3,column:38}},"2":{start:{line:4,column:17},end:{line:4,column:35}},"3":{start:{line:7,column:15},end:{line:7,column:45}},"4":{start:{line:8,column:11},end:{line:8,column:42}},"5":{start:{line:9,column:13},end:{line:9,column:46}},"6":{start:{line:10,column:13},end:{line:10,column:45}},"7":{start:{line:14,column:8},end:{line:14,column:17}},"8":{start:{line:16,column:0},end:{line:16,column:27}},"9":{start:{line:20,column:0},end:{line:103,column:3}},"10":{start:{line:21,column:16},end:{line:21,column:36}},"11":{start:{line:22,column:4},end:{line:102,column:6}},"12":{start:{line:23,column:8},end:{line:25,column:9}},"13":{start:{line:24,column:12},end:{line:24,column:36}},"14":{start:{line:26,column:23},end:{line:26,column:35}},"15":{start:{line:27,column:8},end:{line:29,column:9}},"16":{start:{line:28,column:12},end:{line:28,column:66}},"17":{start:{line:30,column:8},end:{line:32,column:9}},"18":{start:{line:31,column:12},end:{line:31,column:67}},"19":{start:{line:33,column:8},end:{line:35,column:9}},"20":{start:{line:34,column:11},end:{line:34,column:67}},"21":{start:{line:36,column:8},end:{line:38,column:9}},"22":{start:{line:37,column:12},end:{line:37,column:65}},"23":{start:{line:39,column:8},end:{line:41,column:9}},"24":{start:{line:40,column:12},end:{line:40,column:70}},"25":{start:{line:43,column:8},end:{line:45,column:9}},"26":{start:{line:44,column:12},end:{line:44,column:82}},"27":{start:{line:47,column:8},end:{line:95,column:11}},"28":{start:{line:48,column:12},end:{line:51,column:13}},"29":{start:{line:49,column:16},end:{line:49,column:77}},"30":{start:{line:53,column:12},end:{line:64,column:15}},"31":{start:{line:54,column:16},end:{line:63,column:21}},"32":{start:{line:55,column:24},end:{line:58,column:54}},"33":{start:{line:59,column:24},end:{line:59,column:42}},"34":{start:{line:61,column:25},end:{line:63,column:21}},"35":{start:{line:62,column:24},end:{line:62,column:42}},"36":{start:{line:68,column:12},end:{line:92,column:15}},"37":{start:{line:69,column:16},end:{line:91,column:17}},"38":{start:{line:70,column:44},end:{line:80,column:22}},"39":{start:{line:79,column:24},end:{line:79,column:93}},"40":{start:{line:82,column:20},end:{line:86,column:23}},"41":{start:{line:83,column:24},end:{line:83,column:50}},"42":{start:{line:85,column:24},end:{line:85,column:93}},"43":{start:{line:89,column:21},end:{line:91,column:17}},"44":{start:{line:90,column:20},end:{line:90,column:138}},"45":{start:{line:101,column:8},end:{line:101,column:52}},"46":{start:{line:107,column:0},end:{line:111,column:1}},"47":{start:{line:108,column:4},end:{line:110,column:7}},"48":{start:{line:109,column:8},end:{line:109,column:44}},"49":{start:{line:113,column:0},end:{line:113,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:20,column:19},end:{line:20,column:20}},loc:{start:{line:20,column:30},end:{line:103,column:1}},line:20},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:35},end:{line:22,column:36}},loc:{start:{line:22,column:47},end:{line:100,column:5}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:47,column:47},end:{line:47,column:48}},loc:{start:{line:47,column:62},end:{line:95,column:9}},line:47},"3":{name:"(anonymous_3)",decl:{start:{line:53,column:58},end:{line:53,column:59}},loc:{start:{line:53,column:69},end:{line:64,column:13}},line:53},"4":{name:"(anonymous_4)",decl:{start:{line:68,column:91},end:{line:68,column:92}},loc:{start:{line:68,column:109},end:{line:92,column:13}},line:68},"5":{name:"(anonymous_5)",decl:{start:{line:78,column:22},end:{line:78,column:23}},loc:{start:{line:78,column:27},end:{line:80,column:21}},line:78},"6":{name:"(anonymous_6)",decl:{start:{line:82,column:46},end:{line:82,column:47}},loc:{start:{line:82,column:53},end:{line:84,column:21}},line:82},"7":{name:"(anonymous_7)",decl:{start:{line:84,column:29},end:{line:84,column:30}},loc:{start:{line:84,column:34},end:{line:86,column:21}},line:84},"8":{name:"(anonymous_8)",decl:{start:{line:100,column:13},end:{line:100,column:14}},loc:{start:{line:100,column:18},end:{line:102,column:5}},line:100},"9":{name:"(anonymous_9)",decl:{start:{line:108,column:20},end:{line:108,column:21}},loc:{start:{line:108,column:24},end:{line:110,column:5}},line:108}},branchMap:{"0":{loc:{start:{line:23,column:8},end:{line:25,column:9}},type:"if",locations:[{start:{line:23,column:8},end:{line:25,column:9}},{start:{line:23,column:8},end:{line:25,column:9}}],line:23},"1":{loc:{start:{line:27,column:8},end:{line:29,column:9}},type:"if",locations:[{start:{line:27,column:8},end:{line:29,column:9}},{start:{line:27,column:8},end:{line:29,column:9}}],line:27},"2":{loc:{start:{line:30,column:8},end:{line:32,column:9}},type:"if",locations:[{start:{line:30,column:8},end:{line:32,column:9}},{start:{line:30,column:8},end:{line:32,column:9}}],line:30},"3":{loc:{start:{line:33,column:8},end:{line:35,column:9}},type:"if",locations:[{start:{line:33,column:8},end:{line:35,column:9}},{start:{line:33,column:8},end:{line:35,column:9}}],line:33},"4":{loc:{start:{line:36,column:8},end:{line:38,column:9}},type:"if",locations:[{start:{line:36,column:8},end:{line:38,column:9}},{start:{line:36,column:8},end:{line:38,column:9}}],line:36},"5":{loc:{start:{line:39,column:8},end:{line:41,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:41,column:9}},{start:{line:39,column:8},end:{line:41,column:9}}],line:39},"6":{loc:{start:{line:43,column:8},end:{line:45,column:9}},type:"if",locations:[{start:{line:43,column:8},end:{line:45,column:9}},{start:{line:43,column:8},end:{line:45,column:9}}],line:43},"7":{loc:{start:{line:43,column:11},end:{line:43,column:81}},type:"binary-expr",locations:[{start:{line:43,column:11},end:{line:43,column:33}},{start:{line:43,column:37},end:{line:43,column:58}},{start:{line:43,column:62},end:{line:43,column:81}}],line:43},"8":{loc:{start:{line:48,column:12},end:{line:51,column:13}},type:"if",locations:[{start:{line:48,column:12},end:{line:51,column:13}},{start:{line:48,column:12},end:{line:51,column:13}}],line:48},"9":{loc:{start:{line:54,column:16},end:{line:63,column:21}},type:"if",locations:[{start:{line:54,column:16},end:{line:63,column:21}},{start:{line:54,column:16},end:{line:63,column:21}}],line:54},"10":{loc:{start:{line:61,column:25},end:{line:63,column:21}},type:"if",locations:[{start:{line:61,column:25},end:{line:63,column:21}},{start:{line:61,column:25},end:{line:63,column:21}}],line:61},"11":{loc:{start:{line:69,column:16},end:{line:91,column:17}},type:"if",locations:[{start:{line:69,column:16},end:{line:91,column:17}},{start:{line:69,column:16},end:{line:91,column:17}}],line:69},"12":{loc:{start:{line:89,column:21},end:{line:91,column:17}},type:"if",locations:[{start:{line:89,column:21},end:{line:91,column:17}},{start:{line:89,column:21},end:{line:91,column:17}}],line:89},"13":{loc:{start:{line:107,column:0},end:{line:111,column:1}},type:"if",locations:[{start:{line:107,column:0},end:{line:111,column:1}},{start:{line:107,column:0},end:{line:111,column:1}}],line:107}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8dee0617b5986fcd944816288af3424a0a993f6e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2qg90no9yc=function(){return actualCoverage;};return actualCoverage;}cov_2qg90no9yc();//library imports
const express=(cov_2qg90no9yc().s[0]++,require('express'));var bodyParser=(cov_2qg90no9yc().s[1]++,require('body-parser'));const{ObjectID}=(cov_2qg90no9yc().s[2]++,require("mongodb"));//local imports
var{mongoose}=(cov_2qg90no9yc().s[3]++,require("./../db/mongoose.js"));var{track}=(cov_2qg90no9yc().s[4]++,require("./../models/track.js"));var{artist}=(cov_2qg90no9yc().s[5]++,require("./../models/Artists.js"));//artists model
var{images}=(cov_2qg90no9yc().s[6]++,require("./../models/images.js"));// images model
///////////
var app=(cov_2qg90no9yc().s[7]++,express());//configures the middlewear
cov_2qg90no9yc().s[8]++;app.use(bodyParser.json());//post fn takes the url as first paramter and a call back fn 
//the user id is to be passed in the url to know whom this playlist belongs to
cov_2qg90no9yc().s[9]++;app.post('/tracks',(req,res)=>{cov_2qg90no9yc().f[0]++;var token=(cov_2qg90no9yc().s[10]++,req.header('x-auth'));cov_2qg90no9yc().s[11]++;artist.findByToken(token).then(myartist=>{cov_2qg90no9yc().f[1]++;cov_2qg90no9yc().s[12]++;if(!myartist){cov_2qg90no9yc().b[0][0]++;cov_2qg90no9yc().s[13]++;return Promise.reject();}else{cov_2qg90no9yc().b[0][1]++;}var atristId2=(cov_2qg90no9yc().s[14]++,myartist._id);cov_2qg90no9yc().s[15]++;if(!req.body.trackName){cov_2qg90no9yc().b[1][0]++;cov_2qg90no9yc().s[16]++;return res.status(400).send("Track name is required");}else{cov_2qg90no9yc().b[1][1]++;}cov_2qg90no9yc().s[17]++;if(!req.body.genre){cov_2qg90no9yc().b[2][0]++;cov_2qg90no9yc().s[18]++;return res.status(400).send("Track genre is required");}else{cov_2qg90no9yc().b[2][1]++;}cov_2qg90no9yc().s[19]++;if(!req.body.image){cov_2qg90no9yc().b[3][0]++;cov_2qg90no9yc().s[20]++;return res.status(400).send("Track image is required");}else{cov_2qg90no9yc().b[3][1]++;}cov_2qg90no9yc().s[21]++;if(!req.body.url){cov_2qg90no9yc().b[4][0]++;cov_2qg90no9yc().s[22]++;return res.status(400).send("Track url is required");}else{cov_2qg90no9yc().b[4][1]++;}cov_2qg90no9yc().s[23]++;if(!req.body.duration){cov_2qg90no9yc().b[5][0]++;cov_2qg90no9yc().s[24]++;return res.status(400).send("Track duration is required");}else{cov_2qg90no9yc().b[5][1]++;}//IF HEIGHT AND WIDTH ARE NOT REQUIRED -> TO BE REMOVED FROM THE OR CONDITION HERE
cov_2qg90no9yc().s[25]++;if((cov_2qg90no9yc().b[7][0]++,!req.body.image.height)||(cov_2qg90no9yc().b[7][1]++,!req.body.image.width)||(cov_2qg90no9yc().b[7][2]++,!req.body.image.url)){cov_2qg90no9yc().b[6][0]++;cov_2qg90no9yc().s[26]++;return res.status(400).send("Image Info of track has to be provided");}else{cov_2qg90no9yc().b[6][1]++;}cov_2qg90no9yc().s[27]++;track.findOne({url:req.body.url}).then(duptrackurl=>{cov_2qg90no9yc().f[2]++;cov_2qg90no9yc().s[28]++;if(duptrackurl){cov_2qg90no9yc().b[8][0]++;cov_2qg90no9yc().s[29]++;return res.status(409).send("This track is already created");}else{cov_2qg90no9yc().b[8][1]++;}var savedImage;cov_2qg90no9yc().s[30]++;images.findOne({url:req.body.image.url}).then(isImage=>{cov_2qg90no9yc().f[3]++;cov_2qg90no9yc().s[31]++;if(!isImage){cov_2qg90no9yc().b[9][0]++;cov_2qg90no9yc().s[32]++;savedImage=new images({url:req.body.image.url,height:req.body.image.height,width:req.body.image.width});cov_2qg90no9yc().s[33]++;savedImage.save();}else{cov_2qg90no9yc().b[9][1]++;cov_2qg90no9yc().s[34]++;if(isImage){cov_2qg90no9yc().b[10][0]++;cov_2qg90no9yc().s[35]++;savedImage=isImage;}else{cov_2qg90no9yc().b[10][1]++;}}});cov_2qg90no9yc().s[36]++;track.find({$and:[{artistId:atristId2},{trackName:req.body.trackName}]}).then(trackduplicate=>{cov_2qg90no9yc().f[4]++;cov_2qg90no9yc().s[37]++;if(trackduplicate.length==0){cov_2qg90no9yc().b[11][0]++;var trackInstance=(cov_2qg90no9yc().s[38]++,new track({artistId:atristId2,trackName:req.body.trackName,duration:req.body.duration,url:req.body.url,image:savedImage,genre:req.body.genre},e=>{cov_2qg90no9yc().f[5]++;cov_2qg90no9yc().s[39]++;res.status(500).send("Coult not add Track ("+req.body.trackName+")");}));cov_2qg90no9yc().s[40]++;trackInstance.save().then(doc=>{cov_2qg90no9yc().f[6]++;cov_2qg90no9yc().s[41]++;res.status(201).send(doc);}).catch(e=>{cov_2qg90no9yc().f[7]++;cov_2qg90no9yc().s[42]++;res.status(500).send("Coult not add Track ("+req.body.trackName+")");});}else{cov_2qg90no9yc().b[11][1]++;cov_2qg90no9yc().s[43]++;if(trackduplicate.length!=0){cov_2qg90no9yc().b[12][0]++;cov_2qg90no9yc().s[44]++;//409 is code for conflict
return res.status(409).send("Cannot create 2 Tracks with the same name ("+req.body.trackName+") for the same artist");}else{cov_2qg90no9yc().b[12][1]++;}};});});}).catch(e=>{cov_2qg90no9yc().f[8]++;cov_2qg90no9yc().s[45]++;res.status(401).send('Unauthorized Access');});});cov_2qg90no9yc().s[46]++;if(!module.parent){cov_2qg90no9yc().b[13][0]++;cov_2qg90no9yc().s[47]++;app.listen(3000,()=>{cov_2qg90no9yc().f[9]++;cov_2qg90no9yc().s[48]++;console.log("Started on port 3000");});}else{cov_2qg90no9yc().b[13][1]++;}cov_2qg90no9yc().s[49]++;module.exports={app};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZHRyYWNrLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYm9keVBhcnNlciIsIk9iamVjdElEIiwibW9uZ29vc2UiLCJ0cmFjayIsImFydGlzdCIsImltYWdlcyIsImFwcCIsInVzZSIsImpzb24iLCJwb3N0IiwicmVxIiwicmVzIiwidG9rZW4iLCJoZWFkZXIiLCJmaW5kQnlUb2tlbiIsInRoZW4iLCJteWFydGlzdCIsIlByb21pc2UiLCJyZWplY3QiLCJhdHJpc3RJZDIiLCJfaWQiLCJib2R5IiwidHJhY2tOYW1lIiwic3RhdHVzIiwic2VuZCIsImdlbnJlIiwiaW1hZ2UiLCJ1cmwiLCJkdXJhdGlvbiIsImhlaWdodCIsIndpZHRoIiwiZmluZE9uZSIsImR1cHRyYWNrdXJsIiwic2F2ZWRJbWFnZSIsImlzSW1hZ2UiLCJzYXZlIiwiZmluZCIsIiRhbmQiLCJhcnRpc3RJZCIsInRyYWNrZHVwbGljYXRlIiwibGVuZ3RoIiwidHJhY2tJbnN0YW5jZSIsImUiLCJkb2MiLCJjYXRjaCIsIm1vZHVsZSIsInBhcmVudCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOG5RQUFBO0FBQ0EsS0FBTUEsQ0FBQUEsT0FBTywwQkFBRUMsT0FBTyxDQUFDLFNBQUQsQ0FBVCxDQUFiLENBQ0EsR0FBSUMsQ0FBQUEsVUFBVSwwQkFBRUQsT0FBTyxDQUFDLGFBQUQsQ0FBVCxDQUFkLENBQ0EsS0FBTSxDQUFDRSxRQUFELDJCQUFXRixPQUFPLENBQUMsU0FBRCxDQUFsQixDQUFOLENBRUE7QUFDQSxHQUFHLENBQUNHLFFBQUQsMkJBQVlILE9BQU8sQ0FBQyxxQkFBRCxDQUFuQixDQUFILENBQ0EsR0FBRyxDQUFDSSxLQUFELDJCQUFRSixPQUFPLENBQUMsc0JBQUQsQ0FBZixDQUFILENBQ0EsR0FBRyxDQUFDSyxNQUFELDJCQUFVTCxPQUFPLENBQUMsd0JBQUQsQ0FBakIsQ0FBSCxDQUFpRDtBQUNqRCxHQUFHLENB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Q0FBZ0IsSUFBSSxrREFDaEJDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHNCQUFaLEVBQ0gsQ0FGRCxFQUdILENBSkQsa0MseUJBTUFKLE1BQU0sQ0FBQ0ssT0FBUCxDQUFlLENBQUM1QyxHQUFELENBQWYiLCJzb3VyY2VzQ29udGVudCI6WyIvL2xpYnJhcnkgaW1wb3J0c1xyXG5jb25zdCBleHByZXNzPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciBib2R5UGFyc2VyPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG5jb25zdCB7T2JqZWN0SUR9PXJlcXVpcmUoXCJtb25nb2RiXCIpO1xyXG5cclxuLy9sb2NhbCBpbXBvcnRzXHJcbnZhcnttb25nb29zZX09IHJlcXVpcmUoXCIuLy4uL2RiL21vbmdvb3NlLmpzXCIpOyAgXHJcbnZhcnt0cmFja309cmVxdWlyZShcIi4vLi4vbW9kZWxzL3RyYWNrLmpzXCIpO1xyXG52YXJ7YXJ0aXN0fT0gcmVxdWlyZShcIi4vLi4vbW9kZWxzL0FydGlzdHMuanNcIik7ICAvL2FydGlzdHMgbW9kZWxcclxudmFye2ltYWdlc309IHJlcXVpcmUoXCIuLy4uL21vZGVscy9pbWFnZXMuanNcIik7IC8vIGltYWdlcyBtb2RlbFxyXG5cclxuXHJcbi8vLy8vLy8vLy8vXHJcbnZhciBhcHA9ZXhwcmVzcygpO1xyXG4vL2NvbmZpZ3VyZXMgdGhlIG1pZGRsZXdlYXJcclxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XHJcblxyXG4vL3Bvc3QgZm4gdGFrZXMgdGhlIHVybCBhcyBmaXJzdCBwYXJhbXRlciBhbmQgYSBjYWxsIGJhY2sgZm4gXHJcbi8vdGhlIHVzZXIgaWQgaXMgdG8gYmUgcGFzc2VkIGluIHRoZSB1cmwgdG8ga25vdyB3aG9tIHRoaXMgcGxheWxpc3QgYmVsb25ncyB0b1xyXG5hcHAucG9zdCgnL3RyYWNrcycsKHJlcSxyZXMpPT57XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIGFydGlzdC5maW5kQnlUb2tlbih0b2tlbikudGhlbigobXlhcnRpc3QpPT57XHJcbiAgICAgICAgaWYoIW15YXJ0aXN0KXtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhdHJpc3RJZDI9IG15YXJ0aXN0Ll9pZDsgICBcclxuICAgICAgICBpZighcmVxLmJvZHkudHJhY2tOYW1lKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVHJhY2sgbmFtZSBpcyByZXF1aXJlZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIXJlcS5ib2R5LmdlbnJlKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVHJhY2sgZ2VucmUgaXMgcmVxdWlyZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFyZXEuYm9keS5pbWFnZSl7XHJcbiAgICAgICAgICAgcmV0dXJuICByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlRyYWNrIGltYWdlIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighcmVxLmJvZHkudXJsKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVHJhY2sgdXJsIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighcmVxLmJvZHkuZHVyYXRpb24pe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJUcmFjayBkdXJhdGlvbiBpcyByZXF1aXJlZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9JRiBIRUlHSFQgQU5EIFdJRFRIIEFSRSBOT1QgUkVRVUlSRUQgLT4gVE8gQkUgUkVNT1ZFRCBGUk9NIFRIRSBPUiBDT05ESVRJT04gSEVSRVxyXG4gICAgICAgIGlmKCFyZXEuYm9keS5pbWFnZS5oZWlnaHQgfHwgIXJlcS5ib2R5LmltYWdlLndpZHRoIHx8ICFyZXEuYm9keS5pbWFnZS51cmwpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJJbWFnZSBJbmZvIG9mIHRyYWNrIGhhcyB0byBiZSBwcm92aWRlZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRyYWNrLmZpbmRPbmUoe3VybDpyZXEuYm9keS51cmx9KS50aGVuKChkdXB0cmFja3VybCk9PntcclxuICAgICAgICAgICAgaWYoZHVwdHJhY2t1cmwpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5zZW5kKFwiVGhpcyB0cmFjayBpcyBhbHJlYWR5IGNyZWF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc2F2ZWRJbWFnZTtcclxuICAgICAgICAgICAgaW1hZ2VzLmZpbmRPbmUoe3VybDpyZXEuYm9keS5pbWFnZS51cmx9KS50aGVuKChpc0ltYWdlKT0+e1xyXG4gICAgICAgICAgICAgICAgaWYoIWlzSW1hZ2Upe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlZEltYWdlPSBuZXcgaW1hZ2VzICh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDpyZXEuYm9keS5pbWFnZS51cmwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDpyZXEuYm9keS5pbWFnZS5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOnJlcS5ib2R5LmltYWdlLndpZHRoLH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlZEltYWdlLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihpc0ltYWdlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZWRJbWFnZT1pc0ltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgICAgICAgICAgdHJhY2suZmluZCh7JGFuZDpbe2FydGlzdElkOmF0cmlzdElkMn0se3RyYWNrTmFtZTpyZXEuYm9keS50cmFja05hbWUgfV19KS50aGVuKCh0cmFja2R1cGxpY2F0ZSk9PntcclxuICAgICAgICAgICAgICAgIGlmKHRyYWNrZHVwbGljYXRlLmxlbmd0aD09MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmFja0luc3RhbmNlID0gbmV3IHRyYWNrKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aXN0SWQ6IGF0cmlzdElkMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tOYW1lOiByZXEuYm9keS50cmFja05hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOnJlcS5ib2R5LmR1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6cmVxLmJvZHkudXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTpzYXZlZEltYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW5yZTpyZXEuYm9keS5nZW5yZSxcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0sKGUpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKFwiQ291bHQgbm90IGFkZCBUcmFjayAoXCIrcmVxLmJvZHkudHJhY2tOYW1lK1wiKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrSW5zdGFuY2Uuc2F2ZSgpLnRoZW4oKGRvYyk9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDEpLnNlbmQoZG9jKTsgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChcIkNvdWx0IG5vdCBhZGQgVHJhY2sgKFwiK3JlcS5ib2R5LnRyYWNrTmFtZStcIilcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHRyYWNrZHVwbGljYXRlLmxlbmd0aCE9MCl7ICAvLzQwOSBpcyBjb2RlIGZvciBjb25mbGljdFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuc2VuZChcIkNhbm5vdCBjcmVhdGUgMiBUcmFja3Mgd2l0aCB0aGUgc2FtZSBuYW1lIChcIityZXEuYm9keS50cmFja05hbWUrXCIpIGZvciB0aGUgc2FtZSBhcnRpc3RcIik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcblxyXG4gICAgXHJcbiAgICB9KS5jYXRjaCgoZSk9PntcclxuICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnVW5hdXRob3JpemVkIEFjY2VzcycpO1xyXG4gICAgfSlcclxufSk7XHJcblxyXG4gICAgXHJcblxyXG5pZighbW9kdWxlLnBhcmVudCl7XHJcbiAgICBhcHAubGlzdGVuKDMwMDAsKCk9PntcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0ZWQgb24gcG9ydCAzMDAwXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzPXthcHB9O1xyXG5cclxuXHJcbiJdfQ==