function cov_1laoij8lcd(){var path="C:\\Users\\Dell\\Desktop\\Monica\\Controllers\\AlbumController.js";var hash="c4bd41d6f81ab2f3ab4e98e2d7a0e731cdf43abe";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Dell\\Desktop\\Monica\\Controllers\\AlbumController.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:19},end:{line:2,column:47}},"2":{start:{line:3,column:13},end:{line:3,column:39}},"3":{start:{line:4,column:14},end:{line:4,column:43}},"4":{start:{line:5,column:15},end:{line:5,column:44}},"5":{start:{line:6,column:12},end:{line:6,column:35}},"6":{start:{line:8,column:21},end:{line:8,column:62}},"7":{start:{line:10,column:17},end:{line:10,column:35}},"8":{start:{line:12,column:15},end:{line:12,column:31}},"9":{start:{line:13,column:29},end:{line:13,column:75}},"10":{start:{line:21,column:0},end:{line:33,column:7}},"11":{start:{line:22,column:11},end:{line:22,column:24}},"12":{start:{line:23,column:4},end:{line:26,column:5}},"13":{start:{line:25,column:8},end:{line:25,column:50}},"14":{start:{line:28,column:4},end:{line:31,column:42}},"15":{start:{line:29,column:8},end:{line:29,column:70}},"16":{start:{line:29,column:19},end:{line:29,column:69}},"17":{start:{line:30,column:8},end:{line:30,column:33}},"18":{start:{line:31,column:18},end:{line:31,column:40}},"19":{start:{line:36,column:4},end:{line:52,column:11}},"20":{start:{line:37,column:15},end:{line:37,column:28}},"21":{start:{line:38,column:20},end:{line:38,column:40}},"22":{start:{line:39,column:8},end:{line:42,column:9}},"23":{start:{line:41,column:12},end:{line:41,column:62}},"24":{start:{line:43,column:8},end:{line:51,column:42}},"25":{start:{line:44,column:12},end:{line:46,column:13}},"26":{start:{line:45,column:16},end:{line:45,column:40}},"27":{start:{line:47,column:8},end:{line:50,column:46}},"28":{start:{line:48,column:12},end:{line:48,column:74}},"29":{start:{line:48,column:23},end:{line:48,column:73}},"30":{start:{line:49,column:12},end:{line:49,column:49}},"31":{start:{line:50,column:22},end:{line:50,column:44}},"32":{start:{line:51,column:18},end:{line:51,column:40}},"33":{start:{line:54,column:0},end:{line:69,column:3}},"34":{start:{line:55,column:13},end:{line:55,column:26}},"35":{start:{line:56,column:18},end:{line:56,column:27}},"36":{start:{line:57,column:4},end:{line:59,column:5}},"37":{start:{line:58,column:8},end:{line:58,column:50}},"38":{start:{line:60,column:4},end:{line:68,column:7}},"39":{start:{line:61,column:8},end:{line:61,column:25}},"40":{start:{line:62,column:8},end:{line:62,column:41}},"41":{start:{line:64,column:8},end:{line:64,column:25}},"42":{start:{line:65,column:8},end:{line:65,column:63}},"43":{start:{line:65,column:30},end:{line:65,column:63}},"44":{start:{line:66,column:8},end:{line:66,column:68}},"45":{start:{line:66,column:35},end:{line:66,column:68}},"46":{start:{line:78,column:0},end:{line:78,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:21,column:32},end:{line:21,column:33}},loc:{start:{line:21,column:43},end:{line:33,column:5}},line:21},"1":{name:"(anonymous_1)",decl:{start:{line:28,column:39},end:{line:28,column:40}},loc:{start:{line:28,column:50},end:{line:31,column:5}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:13},end:{line:31,column:14}},loc:{start:{line:31,column:18},end:{line:31,column:40}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:36,column:29},end:{line:36,column:30}},loc:{start:{line:36,column:40},end:{line:52,column:9}},line:36},"4":{name:"(anonymous_4)",decl:{start:{line:43,column:37},end:{line:43,column:38}},loc:{start:{line:43,column:45},end:{line:51,column:5}},line:43},"5":{name:"(anonymous_5)",decl:{start:{line:47,column:32},end:{line:47,column:33}},loc:{start:{line:47,column:43},end:{line:50,column:9}},line:47},"6":{name:"(anonymous_6)",decl:{start:{line:50,column:17},end:{line:50,column:18}},loc:{start:{line:50,column:22},end:{line:50,column:44}},line:50},"7":{name:"(anonymous_7)",decl:{start:{line:51,column:13},end:{line:51,column:14}},loc:{start:{line:51,column:18},end:{line:51,column:40}},line:51},"8":{name:"(anonymous_8)",decl:{start:{line:54,column:78},end:{line:54,column:79}},loc:{start:{line:54,column:92},end:{line:69,column:1}},line:54},"9":{name:"(anonymous_9)",decl:{start:{line:60,column:47},end:{line:60,column:48}},loc:{start:{line:60,column:56},end:{line:63,column:5}},line:60},"10":{name:"(anonymous_10)",decl:{start:{line:63,column:13},end:{line:63,column:14}},loc:{start:{line:63,column:22},end:{line:68,column:5}},line:63}},branchMap:{"0":{loc:{start:{line:23,column:4},end:{line:26,column:5}},type:"if",locations:[{start:{line:23,column:4},end:{line:26,column:5}},{start:{line:23,column:4},end:{line:26,column:5}}],line:23},"1":{loc:{start:{line:29,column:8},end:{line:29,column:70}},type:"if",locations:[{start:{line:29,column:8},end:{line:29,column:70}},{start:{line:29,column:8},end:{line:29,column:70}}],line:29},"2":{loc:{start:{line:39,column:8},end:{line:42,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:42,column:9}},{start:{line:39,column:8},end:{line:42,column:9}}],line:39},"3":{loc:{start:{line:44,column:12},end:{line:46,column:13}},type:"if",locations:[{start:{line:44,column:12},end:{line:46,column:13}},{start:{line:44,column:12},end:{line:46,column:13}}],line:44},"4":{loc:{start:{line:48,column:12},end:{line:48,column:74}},type:"if",locations:[{start:{line:48,column:12},end:{line:48,column:74}},{start:{line:48,column:12},end:{line:48,column:74}}],line:48},"5":{loc:{start:{line:57,column:4},end:{line:59,column:5}},type:"if",locations:[{start:{line:57,column:4},end:{line:59,column:5}},{start:{line:57,column:4},end:{line:59,column:5}}],line:57},"6":{loc:{start:{line:65,column:8},end:{line:65,column:63}},type:"if",locations:[{start:{line:65,column:8},end:{line:65,column:63}},{start:{line:65,column:8},end:{line:65,column:63}}],line:65},"7":{loc:{start:{line:66,column:8},end:{line:66,column:68}},type:"if",locations:[{start:{line:66,column:8},end:{line:66,column:68}},{start:{line:66,column:8},end:{line:66,column:68}}],line:66}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c4bd41d6f81ab2f3ab4e98e2d7a0e731cdf43abe"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1laoij8lcd=function(){return actualCoverage;};return actualCoverage;}cov_1laoij8lcd();const express=(cov_1laoij8lcd().s[0]++,require('express'));var{mongoose}=(cov_1laoij8lcd().s[1]++,require("../db/mongoose.js"));const{track}=(cov_1laoij8lcd().s[2]++,require("../models/track"));var{album}=(cov_1laoij8lcd().s[3]++,require("../models/album.js"));var{User}=(cov_1laoij8lcd().s[4]++,require("../models/users.js"));const jwt=(cov_1laoij8lcd().s[5]++,require('jsonwebtoken'));var ArtistServices=(cov_1laoij8lcd().s[6]++,require("./../Services/AlbumServices.js"));const{ObjectID}=(cov_1laoij8lcd().s[7]++,require('mongodb'));const router=(cov_1laoij8lcd().s[8]++,express.Router());var AuthenticationServices=(cov_1laoij8lcd().s[9]++,require("./../Services/AuthenticationService"));/////Get Album Tracks
cov_1laoij8lcd().s[10]++;router.get('/album/tracks/:id',(req,res)=>{cov_1laoij8lcd().f[0]++;var id=(cov_1laoij8lcd().s[11]++,req.params.id);cov_1laoij8lcd().s[12]++;if(!ObjectID.isValid(id)){cov_1laoij8lcd().b[0][0]++;cov_1laoij8lcd().s[13]++;return res.status(404).send("invalid id");}else{cov_1laoij8lcd().b[0][1]++;}cov_1laoij8lcd().s[14]++;album.findById(id,'tracks').then(album=>{cov_1laoij8lcd().f[1]++;cov_1laoij8lcd().s[15]++;if(!album){cov_1laoij8lcd().b[1][0]++;cov_1laoij8lcd().s[16]++;return res.status(404).send("can not find album");}else{cov_1laoij8lcd().b[1][1]++;}cov_1laoij8lcd().s[17]++;return res.send({album});}).catch(e=>{cov_1laoij8lcd().f[2]++;cov_1laoij8lcd().s[18]++;return res.status(400).send();});});///// Get Album
cov_1laoij8lcd().s[19]++;router.get('/album/:id',(req,res)=>{cov_1laoij8lcd().f[3]++;var id=(cov_1laoij8lcd().s[20]++,req.params.id);var token=(cov_1laoij8lcd().s[21]++,req.header('x-auth'));cov_1laoij8lcd().s[22]++;if(!token){cov_1laoij8lcd().b[2][0]++;cov_1laoij8lcd().s[23]++;res.status(401).send('You should pass the token');}else{cov_1laoij8lcd().b[2][1]++;}cov_1laoij8lcd().s[24]++;User.findByToken(token).then(user=>{cov_1laoij8lcd().f[4]++;cov_1laoij8lcd().s[25]++;if(!user){cov_1laoij8lcd().b[3][0]++;cov_1laoij8lcd().s[26]++;return Promise.reject();}else{cov_1laoij8lcd().b[3][1]++;}cov_1laoij8lcd().s[27]++;album.findById(id).then(album=>{cov_1laoij8lcd().f[5]++;cov_1laoij8lcd().s[28]++;if(!album){cov_1laoij8lcd().b[4][0]++;cov_1laoij8lcd().s[29]++;return res.status(404).send("can not find album");}else{cov_1laoij8lcd().b[4][1]++;}cov_1laoij8lcd().s[30]++;return res.status(302).send({album});}).catch(e=>{cov_1laoij8lcd().f[6]++;cov_1laoij8lcd().s[31]++;return res.status(404).send();});}).catch(e=>{cov_1laoij8lcd().f[7]++;cov_1laoij8lcd().s[32]++;return res.status(401).send();});});cov_1laoij8lcd().s[33]++;router.delete('/album/:id/delete',AuthenticationServices.AuthenticateArtists,(req,res)=>{cov_1laoij8lcd().f[8]++;var id=(cov_1laoij8lcd().s[34]++,req.params.id);var decoded=(cov_1laoij8lcd().s[35]++,req.token);cov_1laoij8lcd().s[36]++;if(!ObjectID.isValid(id)){cov_1laoij8lcd().b[5][0]++;cov_1laoij8lcd().s[37]++;return res.status(404).send("invalid id");}else{cov_1laoij8lcd().b[5][1]++;}cov_1laoij8lcd().s[38]++;album.deletebyartist(decoded._id,id).then(str=>{cov_1laoij8lcd().f[9]++;cov_1laoij8lcd().s[39]++;console.log(str);cov_1laoij8lcd().s[40]++;return res.status(200).send(str);}).catch(err=>{cov_1laoij8lcd().f[10]++;cov_1laoij8lcd().s[41]++;console.log(err);cov_1laoij8lcd().s[42]++;if(err="Notfound"){cov_1laoij8lcd().b[6][0]++;cov_1laoij8lcd().s[43]++;return res.status(404).send(err);}else{cov_1laoij8lcd().b[6][1]++;}cov_1laoij8lcd().s[44]++;if(err="NotAuthorized"){cov_1laoij8lcd().b[7][0]++;cov_1laoij8lcd().s[45]++;return res.status(403).send(err);}else{cov_1laoij8lcd().b[7][1]++;}});});// if(module.parent){
//     app.listen(3000,()=>{
//         console.log("Started on port 3000");
//     });
// }
cov_1laoij8lcd().s[46]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFsYnVtQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwidHJhY2siLCJhbGJ1bSIsIlVzZXIiLCJqd3QiLCJBcnRpc3RTZXJ2aWNlcyIsIk9iamVjdElEIiwicm91dGVyIiwiUm91dGVyIiwiQXV0aGVudGljYXRpb25TZXJ2aWNlcyIsImdldCIsInJlcSIsInJlcyIsImlkIiwicGFyYW1zIiwiaXNWYWxpZCIsInN0YXR1cyIsInNlbmQiLCJmaW5kQnlJZCIsInRoZW4iLCJjYXRjaCIsImUiLCJ0b2tlbiIsImhlYWRlciIsImZpbmRCeVRva2VuIiwidXNlciIsIlByb21pc2UiLCJyZWplY3QiLCJkZWxldGUiLCJBdXRoZW50aWNhdGVBcnRpc3RzIiwiZGVjb2RlZCIsImRlbGV0ZWJ5YXJ0aXN0IiwiX2lkIiwic3RyIiwiY29uc29sZSIsImxvZyIsImVyciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJ1ek5BQUEsS0FBTUEsQ0FBQUEsT0FBTywwQkFBQ0MsT0FBTyxDQUFDLFNBQUQsQ0FBUixDQUFiLENBQ0EsR0FBSSxDQUFFQyxRQUFGLDJCQUFlRCxPQUFPLENBQUMsbUJBQUQsQ0FBdEIsQ0FBSixDQUNBLEtBQUssQ0FBQ0UsS0FBRCwyQkFBUUYsT0FBTyxDQUFDLGlCQUFELENBQWYsQ0FBTCxDQUNBLEdBQUksQ0FBQ0csS0FBRCwyQkFBVUgsT0FBTyxDQUFDLG9CQUFELENBQWpCLENBQUosQ0FDQSxHQUFJLENBQUVJLElBQUYsMkJBQVdKLE9BQU8sQ0FBQyxvQkFBRCxDQUFsQixDQUFKLENBQ0EsS0FBTUssQ0FBQUEsR0FBRywwQkFBR0wsT0FBTyxDQUFDLGNBQUQsQ0FBVixDQUFULENBRUEsR0FBSU0sQ0FBQUEsY0FBYywwQkFBR04sT0FBTyxDQUFDLGdDQUFELENBQVYsQ0FBbEIsQ0FFQSxLQUFNLENBQUNPLFFBQUQsMkJBQVdQLE9BQU8sQ0FBQyxTQUFELENBQWxCLENBQU4sQ0FFQSxL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LE1BQWhCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcz1yZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciB7IG1vbmdvb3NlIH0gPSByZXF1aXJlKFwiLi4vZGIvbW9uZ29vc2UuanNcIik7XHJcbmNvbnN0e3RyYWNrfT1yZXF1aXJlKFwiLi4vbW9kZWxzL3RyYWNrXCIpO1xyXG52YXIge2FsYnVtfSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvYWxidW0uanNcIik7XHJcbnZhciB7IFVzZXIgfSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvdXNlcnMuanNcIik7XHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xyXG5cclxudmFyIEFydGlzdFNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvQWxidW1TZXJ2aWNlcy5qc1wiKTtcclxuXHJcbmNvbnN0IHtPYmplY3RJRH09cmVxdWlyZSgnbW9uZ29kYicpO1xyXG5cclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxudmFyIEF1dGhlbnRpY2F0aW9uU2VydmljZXMgPSByZXF1aXJlKFwiLi8uLi9TZXJ2aWNlcy9BdXRoZW50aWNhdGlvblNlcnZpY2VcIik7XHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8vLy9HZXQgQWxidW0gVHJhY2tzXHJcblxyXG5yb3V0ZXIuZ2V0KCcvYWxidW0vdHJhY2tzLzppZCcsIChyZXEscmVzKT0+e1xyXG4gICAgdmFyIGlkPXJlcS5wYXJhbXMuaWQ7XHJcbiAgICBpZighT2JqZWN0SUQuaXNWYWxpZChpZCkpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKFwiaW52YWxpZCBpZFwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWxidW0uZmluZEJ5SWQoaWQgLCAndHJhY2tzJykudGhlbigoYWxidW0pID0+IHtcclxuICAgICAgICBpZighYWxidW0pe3JldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZChcImNhbiBub3QgZmluZCBhbGJ1bVwiKTt9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHthbGJ1bX0pO1xyXG4gICAgfSkuY2F0Y2goKGUpPT5yZXMuc3RhdHVzKDQwMCkuc2VuZCgpKTtcclxuICAgIFxyXG4gICAgfSk7XHJcblxyXG4vLy8vLyBHZXQgQWxidW1cclxuICAgIHJvdXRlci5nZXQoJy9hbGJ1bS86aWQnLCAocmVxLHJlcyk9PntcclxuICAgICAgICB2YXIgaWQ9cmVxLnBhcmFtcy5pZDtcclxuICAgICAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgICAgICBpZighdG9rZW4pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnWW91IHNob3VsZCBwYXNzIHRoZSB0b2tlbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBVc2VyLmZpbmRCeVRva2VuKHRva2VuKS50aGVuKCh1c2VyKT0+e1xyXG4gICAgICAgICAgICBpZighdXNlcil7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGFsYnVtLmZpbmRCeUlkKGlkKS50aGVuKChhbGJ1bSkgPT4ge1xyXG4gICAgICAgICAgICBpZighYWxidW0pe3JldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZChcImNhbiBub3QgZmluZCBhbGJ1bVwiKTt9XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDMwMikuc2VuZCh7YWxidW19KTtcclxuICAgICAgICB9KS5jYXRjaCgoZSk9PnJlcy5zdGF0dXMoNDA0KS5zZW5kKCkpO1xyXG4gICAgfSkuY2F0Y2goKGUpPT5yZXMuc3RhdHVzKDQwMSkuc2VuZCgpKTtcclxuICAgICAgICB9KTsgICAgXHJcblxyXG5yb3V0ZXIuZGVsZXRlKCcvYWxidW0vOmlkL2RlbGV0ZScsQXV0aGVudGljYXRpb25TZXJ2aWNlcy5BdXRoZW50aWNhdGVBcnRpc3RzLCAocmVxLCByZXMpID0+IHtcclxuICAgIHZhciBpZCA9IHJlcS5wYXJhbXMuaWQ7XHJcbiAgICB2YXIgZGVjb2RlZCA9IHJlcS50b2tlbjtcclxuICAgIGlmICghT2JqZWN0SUQuaXNWYWxpZChpZCkpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJpbnZhbGlkIGlkXCIpO1xyXG4gICAgfVxyXG4gICAgYWxidW0uZGVsZXRlYnlhcnRpc3QoZGVjb2RlZC5faWQsIGlkKS50aGVuKChzdHIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChzdHIpO1xyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgaWYgKGVyciA9IFwiTm90Zm91bmRcIikgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKGVycik7XHJcbiAgICAgICAgaWYgKGVyciA9IFwiTm90QXV0aG9yaXplZFwiKSByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoZXJyKTtcclxuXHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5cclxuLy8gaWYobW9kdWxlLnBhcmVudCl7XHJcbi8vICAgICBhcHAubGlzdGVuKDMwMDAsKCk9PntcclxuLy8gICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0ZWQgb24gcG9ydCAzMDAwXCIpO1xyXG4vLyAgICAgfSk7XHJcbi8vIH1cclxuXHJcbm1vZHVsZS5leHBvcnRzPSByb3V0ZXI7Il19