function cov_md63xmofc(){var path="C:\\Users\\Dell\\Desktop\\new\\Controllers\\AlbumController.js";var hash="75f45e76a2c066bac27b5b94b72b92340cc74ffb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Dell\\Desktop\\new\\Controllers\\AlbumController.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:19},end:{line:2,column:47}},"2":{start:{line:3,column:13},end:{line:3,column:39}},"3":{start:{line:4,column:14},end:{line:4,column:43}},"4":{start:{line:5,column:15},end:{line:5,column:44}},"5":{start:{line:6,column:12},end:{line:6,column:35}},"6":{start:{line:8,column:21},end:{line:8,column:62}},"7":{start:{line:10,column:17},end:{line:10,column:35}},"8":{start:{line:12,column:15},end:{line:12,column:31}},"9":{start:{line:13,column:29},end:{line:13,column:75}},"10":{start:{line:21,column:0},end:{line:33,column:7}},"11":{start:{line:22,column:11},end:{line:22,column:24}},"12":{start:{line:23,column:4},end:{line:26,column:5}},"13":{start:{line:25,column:8},end:{line:25,column:50}},"14":{start:{line:28,column:4},end:{line:31,column:42}},"15":{start:{line:29,column:8},end:{line:29,column:70}},"16":{start:{line:29,column:19},end:{line:29,column:69}},"17":{start:{line:30,column:8},end:{line:30,column:33}},"18":{start:{line:31,column:18},end:{line:31,column:40}},"19":{start:{line:36,column:4},end:{line:52,column:11}},"20":{start:{line:37,column:15},end:{line:37,column:28}},"21":{start:{line:38,column:20},end:{line:38,column:40}},"22":{start:{line:39,column:8},end:{line:42,column:9}},"23":{start:{line:41,column:12},end:{line:41,column:62}},"24":{start:{line:43,column:8},end:{line:51,column:42}},"25":{start:{line:44,column:12},end:{line:46,column:13}},"26":{start:{line:45,column:16},end:{line:45,column:40}},"27":{start:{line:47,column:8},end:{line:50,column:46}},"28":{start:{line:48,column:12},end:{line:48,column:74}},"29":{start:{line:48,column:23},end:{line:48,column:73}},"30":{start:{line:49,column:12},end:{line:49,column:49}},"31":{start:{line:50,column:22},end:{line:50,column:44}},"32":{start:{line:51,column:18},end:{line:51,column:40}},"33":{start:{line:54,column:0},end:{line:69,column:3}},"34":{start:{line:55,column:13},end:{line:55,column:26}},"35":{start:{line:56,column:18},end:{line:56,column:27}},"36":{start:{line:57,column:4},end:{line:59,column:5}},"37":{start:{line:58,column:8},end:{line:58,column:50}},"38":{start:{line:60,column:4},end:{line:68,column:7}},"39":{start:{line:61,column:8},end:{line:61,column:25}},"40":{start:{line:62,column:8},end:{line:62,column:41}},"41":{start:{line:64,column:8},end:{line:64,column:25}},"42":{start:{line:65,column:8},end:{line:65,column:63}},"43":{start:{line:65,column:30},end:{line:65,column:63}},"44":{start:{line:66,column:8},end:{line:66,column:68}},"45":{start:{line:66,column:35},end:{line:66,column:68}},"46":{start:{line:73,column:0},end:{line:127,column:3}},"47":{start:{line:74,column:18},end:{line:74,column:31}},"48":{start:{line:75,column:16},end:{line:75,column:36}},"49":{start:{line:76,column:4},end:{line:79,column:5}},"50":{start:{line:78,column:8},end:{line:78,column:84}},"51":{start:{line:80,column:4},end:{line:83,column:5}},"52":{start:{line:82,column:8},end:{line:82,column:50}},"53":{start:{line:84,column:4},end:{line:88,column:6}},"54":{start:{line:85,column:4},end:{line:87,column:5}},"55":{start:{line:86,column:8},end:{line:86,column:74}},"56":{start:{line:89,column:4},end:{line:126,column:6}},"57":{start:{line:90,column:8},end:{line:93,column:9}},"58":{start:{line:92,column:12},end:{line:92,column:35}},"59":{start:{line:94,column:8},end:{line:94,column:38}},"60":{start:{line:95,column:17},end:{line:95,column:40}},"61":{start:{line:96,column:8},end:{line:125,column:9}},"62":{start:{line:98,column:12},end:{line:98,column:61}},"63":{start:{line:99,column:12},end:{line:99,column:44}},"64":{start:{line:100,column:12},end:{line:100,column:24}},"65":{start:{line:101,column:12},end:{line:105,column:18}},"66":{start:{line:102,column:16},end:{line:102,column:45}},"67":{start:{line:103,column:16},end:{line:103,column:44}},"68":{start:{line:104,column:16},end:{line:104,column:29}},"69":{start:{line:106,column:12},end:{line:106,column:35}},"70":{start:{line:109,column:8},end:{line:115,column:9}},"71":{start:{line:109,column:20},end:{line:109,column:21}},"72":{start:{line:111,column:12},end:{line:114,column:13}},"73":{start:{line:113,column:16},end:{line:113,column:91}},"74":{start:{line:116,column:8},end:{line:116,column:59}},"75":{start:{line:117,column:8},end:{line:117,column:40}},"76":{start:{line:118,column:8},end:{line:118,column:20}},"77":{start:{line:119,column:8},end:{line:123,column:14}},"78":{start:{line:120,column:12},end:{line:120,column:41}},"79":{start:{line:121,column:12},end:{line:121,column:40}},"80":{start:{line:122,column:12},end:{line:122,column:25}},"81":{start:{line:124,column:8},end:{line:124,column:31}},"82":{start:{line:136,column:0},end:{line:136,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:21,column:32},end:{line:21,column:33}},loc:{start:{line:21,column:43},end:{line:33,column:5}},line:21},"1":{name:"(anonymous_1)",decl:{start:{line:28,column:39},end:{line:28,column:40}},loc:{start:{line:28,column:50},end:{line:31,column:5}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:13},end:{line:31,column:14}},loc:{start:{line:31,column:18},end:{line:31,column:40}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:36,column:29},end:{line:36,column:30}},loc:{start:{line:36,column:40},end:{line:52,column:9}},line:36},"4":{name:"(anonymous_4)",decl:{start:{line:43,column:37},end:{line:43,column:38}},loc:{start:{line:43,column:45},end:{line:51,column:5}},line:43},"5":{name:"(anonymous_5)",decl:{start:{line:47,column:32},end:{line:47,column:33}},loc:{start:{line:47,column:43},end:{line:50,column:9}},line:47},"6":{name:"(anonymous_6)",decl:{start:{line:50,column:17},end:{line:50,column:18}},loc:{start:{line:50,column:22},end:{line:50,column:44}},line:50},"7":{name:"(anonymous_7)",decl:{start:{line:51,column:13},end:{line:51,column:14}},loc:{start:{line:51,column:18},end:{line:51,column:40}},line:51},"8":{name:"(anonymous_8)",decl:{start:{line:54,column:78},end:{line:54,column:79}},loc:{start:{line:54,column:92},end:{line:69,column:1}},line:54},"9":{name:"(anonymous_9)",decl:{start:{line:60,column:47},end:{line:60,column:48}},loc:{start:{line:60,column:56},end:{line:63,column:5}},line:60},"10":{name:"(anonymous_10)",decl:{start:{line:63,column:13},end:{line:63,column:14}},loc:{start:{line:63,column:22},end:{line:68,column:5}},line:63},"11":{name:"(anonymous_11)",decl:{start:{line:73,column:30},end:{line:73,column:31}},loc:{start:{line:73,column:44},end:{line:127,column:1}},line:73},"12":{name:"(anonymous_12)",decl:{start:{line:84,column:38},end:{line:84,column:39}},loc:{start:{line:84,column:49},end:{line:88,column:5}},line:84},"13":{name:"(anonymous_13)",decl:{start:{line:89,column:33},end:{line:89,column:34}},loc:{start:{line:89,column:42},end:{line:126,column:5}},line:89},"14":{name:"(anonymous_14)",decl:{start:{line:101,column:46},end:{line:101,column:47}},loc:{start:{line:101,column:57},end:{line:105,column:17}},line:101},"15":{name:"(anonymous_15)",decl:{start:{line:119,column:42},end:{line:119,column:43}},loc:{start:{line:119,column:53},end:{line:123,column:13}},line:119}},branchMap:{"0":{loc:{start:{line:23,column:4},end:{line:26,column:5}},type:"if",locations:[{start:{line:23,column:4},end:{line:26,column:5}},{start:{line:23,column:4},end:{line:26,column:5}}],line:23},"1":{loc:{start:{line:29,column:8},end:{line:29,column:70}},type:"if",locations:[{start:{line:29,column:8},end:{line:29,column:70}},{start:{line:29,column:8},end:{line:29,column:70}}],line:29},"2":{loc:{start:{line:39,column:8},end:{line:42,column:9}},type:"if",locations:[{start:{line:39,column:8},end:{line:42,column:9}},{start:{line:39,column:8},end:{line:42,column:9}}],line:39},"3":{loc:{start:{line:44,column:12},end:{line:46,column:13}},type:"if",locations:[{start:{line:44,column:12},end:{line:46,column:13}},{start:{line:44,column:12},end:{line:46,column:13}}],line:44},"4":{loc:{start:{line:48,column:12},end:{line:48,column:74}},type:"if",locations:[{start:{line:48,column:12},end:{line:48,column:74}},{start:{line:48,column:12},end:{line:48,column:74}}],line:48},"5":{loc:{start:{line:57,column:4},end:{line:59,column:5}},type:"if",locations:[{start:{line:57,column:4},end:{line:59,column:5}},{start:{line:57,column:4},end:{line:59,column:5}}],line:57},"6":{loc:{start:{line:65,column:8},end:{line:65,column:63}},type:"if",locations:[{start:{line:65,column:8},end:{line:65,column:63}},{start:{line:65,column:8},end:{line:65,column:63}}],line:65},"7":{loc:{start:{line:66,column:8},end:{line:66,column:68}},type:"if",locations:[{start:{line:66,column:8},end:{line:66,column:68}},{start:{line:66,column:8},end:{line:66,column:68}}],line:66},"8":{loc:{start:{line:76,column:4},end:{line:79,column:5}},type:"if",locations:[{start:{line:76,column:4},end:{line:79,column:5}},{start:{line:76,column:4},end:{line:79,column:5}}],line:76},"9":{loc:{start:{line:80,column:4},end:{line:83,column:5}},type:"if",locations:[{start:{line:80,column:4},end:{line:83,column:5}},{start:{line:80,column:4},end:{line:83,column:5}}],line:80},"10":{loc:{start:{line:85,column:4},end:{line:87,column:5}},type:"if",locations:[{start:{line:85,column:4},end:{line:87,column:5}},{start:{line:85,column:4},end:{line:87,column:5}}],line:85},"11":{loc:{start:{line:90,column:8},end:{line:93,column:9}},type:"if",locations:[{start:{line:90,column:8},end:{line:93,column:9}},{start:{line:90,column:8},end:{line:93,column:9}}],line:90},"12":{loc:{start:{line:96,column:8},end:{line:125,column:9}},type:"if",locations:[{start:{line:96,column:8},end:{line:125,column:9}},{start:{line:96,column:8},end:{line:125,column:9}}],line:96},"13":{loc:{start:{line:111,column:12},end:{line:114,column:13}},type:"if",locations:[{start:{line:111,column:12},end:{line:114,column:13}},{start:{line:111,column:12},end:{line:114,column:13}}],line:111}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"75f45e76a2c066bac27b5b94b72b92340cc74ffb"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_md63xmofc=function(){return actualCoverage;};return actualCoverage;}cov_md63xmofc();const express=(cov_md63xmofc().s[0]++,require('express'));var{mongoose}=(cov_md63xmofc().s[1]++,require("../db/mongoose.js"));const{track}=(cov_md63xmofc().s[2]++,require("../models/track"));var{album}=(cov_md63xmofc().s[3]++,require("../models/album.js"));var{User}=(cov_md63xmofc().s[4]++,require("../models/users.js"));const jwt=(cov_md63xmofc().s[5]++,require('jsonwebtoken'));var ArtistServices=(cov_md63xmofc().s[6]++,require("./../Services/AlbumServices.js"));const{ObjectID}=(cov_md63xmofc().s[7]++,require('mongodb'));const router=(cov_md63xmofc().s[8]++,express.Router());var AuthenticationServices=(cov_md63xmofc().s[9]++,require("./../Services/AuthenticationService"));/////Get Album Tracks
cov_md63xmofc().s[10]++;router.get('/album/tracks/:id',(req,res)=>{cov_md63xmofc().f[0]++;var id=(cov_md63xmofc().s[11]++,req.params.id);cov_md63xmofc().s[12]++;if(!ObjectID.isValid(id)){cov_md63xmofc().b[0][0]++;cov_md63xmofc().s[13]++;return res.status(404).send("invalid id");}else{cov_md63xmofc().b[0][1]++;}cov_md63xmofc().s[14]++;album.findById(id,'tracks').then(album=>{cov_md63xmofc().f[1]++;cov_md63xmofc().s[15]++;if(!album){cov_md63xmofc().b[1][0]++;cov_md63xmofc().s[16]++;return res.status(404).send("can not find album");}else{cov_md63xmofc().b[1][1]++;}cov_md63xmofc().s[17]++;return res.send({album});}).catch(e=>{cov_md63xmofc().f[2]++;cov_md63xmofc().s[18]++;return res.status(400).send();});});///// Get Album
cov_md63xmofc().s[19]++;router.get('/album/:id',(req,res)=>{cov_md63xmofc().f[3]++;var id=(cov_md63xmofc().s[20]++,req.params.id);var token=(cov_md63xmofc().s[21]++,req.header('x-auth'));cov_md63xmofc().s[22]++;if(!token){cov_md63xmofc().b[2][0]++;cov_md63xmofc().s[23]++;res.status(401).send('You should pass the token');}else{cov_md63xmofc().b[2][1]++;}cov_md63xmofc().s[24]++;User.findByToken(token).then(user=>{cov_md63xmofc().f[4]++;cov_md63xmofc().s[25]++;if(!user){cov_md63xmofc().b[3][0]++;cov_md63xmofc().s[26]++;return Promise.reject();}else{cov_md63xmofc().b[3][1]++;}cov_md63xmofc().s[27]++;album.findById(id).then(album=>{cov_md63xmofc().f[5]++;cov_md63xmofc().s[28]++;if(!album){cov_md63xmofc().b[4][0]++;cov_md63xmofc().s[29]++;return res.status(404).send("can not find album");}else{cov_md63xmofc().b[4][1]++;}cov_md63xmofc().s[30]++;return res.status(302).send({album});}).catch(e=>{cov_md63xmofc().f[6]++;cov_md63xmofc().s[31]++;return res.status(404).send();});}).catch(e=>{cov_md63xmofc().f[7]++;cov_md63xmofc().s[32]++;return res.status(401).send();});});cov_md63xmofc().s[33]++;router.delete('/album/:id/delete',AuthenticationServices.AuthenticateArtists,(req,res)=>{cov_md63xmofc().f[8]++;var id=(cov_md63xmofc().s[34]++,req.params.id);var decoded=(cov_md63xmofc().s[35]++,req.token);cov_md63xmofc().s[36]++;if(!ObjectID.isValid(id)){cov_md63xmofc().b[5][0]++;cov_md63xmofc().s[37]++;return res.status(404).send("invalid id");}else{cov_md63xmofc().b[5][1]++;}cov_md63xmofc().s[38]++;album.deletebyartist(decoded._id,id).then(str=>{cov_md63xmofc().f[9]++;cov_md63xmofc().s[39]++;console.log(str);cov_md63xmofc().s[40]++;return res.status(200).send(str);}).catch(err=>{cov_md63xmofc().f[10]++;cov_md63xmofc().s[41]++;console.log(err);cov_md63xmofc().s[42]++;if(err="Notfound"){cov_md63xmofc().b[6][0]++;cov_md63xmofc().s[43]++;return res.status(404).send(err);}else{cov_md63xmofc().b[6][1]++;}cov_md63xmofc().s[44]++;if(err="NotAuthorized"){cov_md63xmofc().b[7][0]++;cov_md63xmofc().s[45]++;return res.status(403).send(err);}else{cov_md63xmofc().b[7][1]++;}});});///////// Like album /////////////
cov_md63xmofc().s[46]++;router.post('/album/like/:id',(req,res)=>{cov_md63xmofc().f[11]++;var albumId=(cov_md63xmofc().s[47]++,req.params.id);var token=(cov_md63xmofc().s[48]++,req.header('x-auth'));cov_md63xmofc().s[49]++;if(!token){cov_md63xmofc().b[8][0]++;cov_md63xmofc().s[50]++;res.status(400).send('You should Pass a token to access your liked tracks');}else{cov_md63xmofc().b[8][1]++;}cov_md63xmofc().s[51]++;if(!ObjectID.isValid(albumId)){cov_md63xmofc().b[9][0]++;cov_md63xmofc().s[52]++;return res.status(404).send("invalid id");}else{cov_md63xmofc().b[9][1]++;}cov_md63xmofc().s[53]++;album.findOne({_id:albumId}).then(album=>{cov_md63xmofc().f[12]++;cov_md63xmofc().s[54]++;if(!album){cov_md63xmofc().b[10][0]++;cov_md63xmofc().s[55]++;res.status(404).send('their is no such an album in the database');}else{cov_md63xmofc().b[10][1]++;}});cov_md63xmofc().s[56]++;User.findByToken(token).then(user=>{cov_md63xmofc().f[13]++;cov_md63xmofc().s[57]++;if(!user){cov_md63xmofc().b[11][0]++;cov_md63xmofc().s[58]++;res.status(401).send();}else{cov_md63xmofc().b[11][1]++;}cov_md63xmofc().s[59]++;console.log('user was found');var len=(cov_md63xmofc().s[60]++,user.likedAlbums.length);cov_md63xmofc().s[61]++;if(len==0){cov_md63xmofc().b[12][0]++;cov_md63xmofc().s[62]++;user.likedAlbums[0]=ObjectID(albumId.toString());cov_md63xmofc().s[63]++;user.markModified('likedAlbums');cov_md63xmofc().s[64]++;user.save();cov_md63xmofc().s[65]++;album.findOne({_id:albumId}).then(album=>{cov_md63xmofc().f[14]++;cov_md63xmofc().s[66]++;album.likes=album.likes+1;cov_md63xmofc().s[67]++;album.markModified('likes');cov_md63xmofc().s[68]++;album.save();});cov_md63xmofc().s[69]++;res.status(200).send();}else{cov_md63xmofc().b[12][1]++;cov_md63xmofc().s[70]++;for(var i=(cov_md63xmofc().s[71]++,0);i<len;i++){cov_md63xmofc().s[72]++;if(albumId==user.likedAlbums[i]){cov_md63xmofc().b[13][0]++;cov_md63xmofc().s[73]++;return res.status(403).send('you are trying to like the same track twice');}else{cov_md63xmofc().b[13][1]++;}}cov_md63xmofc().s[74]++;user.likedAlbums[len]=ObjectID(albumId.toString());cov_md63xmofc().s[75]++;user.markModified('likedTracks');cov_md63xmofc().s[76]++;user.save();cov_md63xmofc().s[77]++;album.findOne({_id:albumId}).then(album=>{cov_md63xmofc().f[15]++;cov_md63xmofc().s[78]++;album.likes=album.likes+1;cov_md63xmofc().s[79]++;album.markModified('likes');cov_md63xmofc().s[80]++;album.save();});cov_md63xmofc().s[81]++;res.status(200).send();}});});// if(module.parent){
//     app.listen(3000,()=>{
//         console.log("Started on port 3000");
//     });
// }
cov_md63xmofc().s[82]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFsYnVtQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwidHJhY2siLCJhbGJ1bSIsIlVzZXIiLCJqd3QiLCJBcnRpc3RTZXJ2aWNlcyIsIk9iamVjdElEIiwicm91dGVyIiwiUm91dGVyIiwiQXV0aGVudGljYXRpb25TZXJ2aWNlcyIsImdldCIsInJlcSIsInJlcyIsImlkIiwicGFyYW1zIiwiaXNWYWxpZCIsInN0YXR1cyIsInNlbmQiLCJmaW5kQnlJZCIsInRoZW4iLCJjYXRjaCIsImUiLCJ0b2tlbiIsImhlYWRlciIsImZpbmRCeVRva2VuIiwidXNlciIsIlByb21pc2UiLCJyZWplY3QiLCJkZWxldGUiLCJBdXRoZW50aWNhdGVBcnRpc3RzIiwiZGVjb2RlZCIsImRlbGV0ZWJ5YXJ0aXN0IiwiX2lkIiwic3RyIiwiY29uc29sZSIsImxvZyIsImVyciIsInBvc3QiLCJhbGJ1bUlkIiwiZmluZE9uZSIsImxlbiIsImxpa2VkQWxidW1zIiwibGVuZ3RoIiwidG9TdHJpbmciLCJtYXJrTW9kaWZpZWQiLCJzYXZlIiwibGlrZXMiLCJpIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjhoV0FBQSxLQUFNQSxDQUFBQSxPQUFPLHlCQUFDQyxPQUFPLENBQUMsU0FBRCxDQUFSLENBQWIsQ0FDQSxHQUFJLENBQUVDLFFBQUYsMEJBQWVELE9BQU8sQ0FBQyxtQkFBRCxDQUF0QixDQUFKLENBQ0EsS0FBSyxDQUFDRSxLQUFELDBCQUFRRixPQUFPLENBQUMsaUJBQUQsQ0FBZixDQUFMLENBQ0EsR0FBSSxDQUFDRyxLQUFELDBCQUFVSCxPQUFPLENBQUMsb0JBQUQsQ0FBakIsQ0FBSixDQUNBLEdBQUksQ0FBRUksSUFBRiwwQkFBV0osT0FBTyxDQUFDLG9CQUFELENBQWxCLENBQUosQ0FDQSxLQUFNSyxDQUFBQSxHQUFHLHlCQUFHTCxPQUFPLENBQUMsY0FBRCxDQUFWLENBQVQsQ0FFQSxHQUFJTSxDQUFB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QUFELENBQTlCLENBUkksd0JBU0psQixJQUFJLENBQUNtQixZQUFMLENBQWtCLGFBQWxCLEVBVEksd0JBVUpuQixJQUFJLENBQUNvQixJQUFMLEdBVkksd0JBV0ozQyxLQUFLLENBQUNxQyxPQUFOLENBQWMsQ0FBQ1AsR0FBRyxDQUFDTSxPQUFMLENBQWQsRUFBNkJuQixJQUE3QixDQUFtQ2pCLEtBQUQsRUFBVyxpREFDekNBLEtBQUssQ0FBQzRDLEtBQU4sQ0FBYzVDLEtBQUssQ0FBQzRDLEtBQU4sQ0FBYSxDQUEzQixDQUR5Qyx3QkFFekM1QyxLQUFLLENBQUMwQyxZQUFOLENBQW1CLE9BQW5CLEVBRnlDLHdCQUd6QzFDLEtBQUssQ0FBQzJDLElBQU4sR0FDQyxDQUpMLEVBWEksd0JBZ0JKakMsR0FBRyxDQUFDSSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsR0FDQyxDQUNKLENBckNELEVBc0NILENBdERELEVBeURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7d0JBRUErQixNQUFNLENBQUNDLE9BQVAsQ0FBZ0IxQyxNQUFoQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3M9cmVxdWlyZSgnZXhwcmVzcycpO1xyXG52YXIgeyBtb25nb29zZSB9ID0gcmVxdWlyZShcIi4uL2RiL21vbmdvb3NlLmpzXCIpO1xyXG5jb25zdHt0cmFja309cmVxdWlyZShcIi4uL21vZGVscy90cmFja1wiKTtcclxudmFyIHthbGJ1bX0gPSByZXF1aXJlKFwiLi4vbW9kZWxzL2FsYnVtLmpzXCIpO1xyXG52YXIgeyBVc2VyIH0gPSByZXF1aXJlKFwiLi4vbW9kZWxzL3VzZXJzLmpzXCIpO1xyXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuXHJcbnZhciBBcnRpc3RTZXJ2aWNlcyA9IHJlcXVpcmUoXCIuLy4uL1NlcnZpY2VzL0FsYnVtU2VydmljZXMuanNcIik7XHJcblxyXG5jb25zdCB7T2JqZWN0SUR9PXJlcXVpcmUoJ21vbmdvZGInKTtcclxuXHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbnZhciBBdXRoZW50aWNhdGlvblNlcnZpY2VzID0gcmVxdWlyZShcIi4vLi4vU2VydmljZXMvQXV0aGVudGljYXRpb25TZXJ2aWNlXCIpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vLy8vR2V0IEFsYnVtIFRyYWNrc1xyXG5cclxucm91dGVyLmdldCgnL2FsYnVtL3RyYWNrcy86aWQnLCAocmVxLHJlcyk9PntcclxuICAgIHZhciBpZD1yZXEucGFyYW1zLmlkO1xyXG4gICAgaWYoIU9iamVjdElELmlzVmFsaWQoaWQpKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZChcImludmFsaWQgaWRcIik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFsYnVtLmZpbmRCeUlkKGlkICwgJ3RyYWNrcycpLnRoZW4oKGFsYnVtKSA9PiB7XHJcbiAgICAgICAgaWYoIWFsYnVtKXtyZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJjYW4gbm90IGZpbmQgYWxidW1cIik7fVxyXG4gICAgICAgIHJldHVybiByZXMuc2VuZCh7YWxidW19KTtcclxuICAgIH0pLmNhdGNoKChlKT0+cmVzLnN0YXR1cyg0MDApLnNlbmQoKSk7XHJcbiAgICBcclxuICAgIH0pO1xyXG5cclxuLy8vLy8gR2V0IEFsYnVtXHJcbiAgICByb3V0ZXIuZ2V0KCcvYWxidW0vOmlkJywgKHJlcSxyZXMpPT57XHJcbiAgICAgICAgdmFyIGlkPXJlcS5wYXJhbXMuaWQ7XHJcbiAgICAgICAgdmFyIHRva2VuID0gcmVxLmhlYWRlcigneC1hdXRoJyk7XHJcbiAgICAgICAgaWYoIXRva2VuKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ1lvdSBzaG91bGQgcGFzcyB0aGUgdG9rZW4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgVXNlci5maW5kQnlUb2tlbih0b2tlbikudGhlbigodXNlcik9PntcclxuICAgICAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBhbGJ1bS5maW5kQnlJZChpZCkudGhlbigoYWxidW0pID0+IHtcclxuICAgICAgICAgICAgaWYoIWFsYnVtKXtyZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJjYW4gbm90IGZpbmQgYWxidW1cIik7fVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygzMDIpLnNlbmQoe2FsYnVtfSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKGUpPT5yZXMuc3RhdHVzKDQwNCkuc2VuZCgpKTtcclxuICAgIH0pLmNhdGNoKChlKT0+cmVzLnN0YXR1cyg0MDEpLnNlbmQoKSk7XHJcbiAgICAgICAgfSk7ICAgIFxyXG5cclxucm91dGVyLmRlbGV0ZSgnL2FsYnVtLzppZC9kZWxldGUnLEF1dGhlbnRpY2F0aW9uU2VydmljZXMuQXV0aGVudGljYXRlQXJ0aXN0cywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB2YXIgaWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgdmFyIGRlY29kZWQgPSByZXEudG9rZW47XHJcbiAgICBpZiAoIU9iamVjdElELmlzVmFsaWQoaWQpKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKFwiaW52YWxpZCBpZFwiKTtcclxuICAgIH1cclxuICAgIGFsYnVtLmRlbGV0ZWJ5YXJ0aXN0KGRlY29kZWQuX2lkLCBpZCkudGhlbigoc3RyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc3RyKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoc3RyKTtcclxuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgIGlmIChlcnIgPSBcIk5vdGZvdW5kXCIpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZChlcnIpO1xyXG4gICAgICAgIGlmIChlcnIgPSBcIk5vdEF1dGhvcml6ZWRcIikgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKGVycik7XHJcblxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuXHJcbi8vLy8vLy8vLyBMaWtlIGFsYnVtIC8vLy8vLy8vLy8vLy9cclxucm91dGVyLnBvc3QoJy9hbGJ1bS9saWtlLzppZCcsKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB2YXIgYWxidW1JZCA9IHJlcS5wYXJhbXMuaWQ7XHJcbiAgICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyKCd4LWF1dGgnKTtcclxuICAgIGlmKCF0b2tlbilcclxuICAgIHtcclxuICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCgnWW91IHNob3VsZCBQYXNzIGEgdG9rZW4gdG8gYWNjZXNzIHlvdXIgbGlrZWQgdHJhY2tzJyk7XHJcbiAgICB9XHJcbiAgICBpZighT2JqZWN0SUQuaXNWYWxpZChhbGJ1bUlkKSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoXCJpbnZhbGlkIGlkXCIpO1xyXG4gICAgfVxyXG4gICAgYWxidW0uZmluZE9uZSh7X2lkOmFsYnVtSWR9KS50aGVuKChhbGJ1bSkgPT4ge1xyXG4gICAgaWYoIWFsYnVtKXtcclxuICAgICAgICByZXMuc3RhdHVzKDQwNCkuc2VuZCgndGhlaXIgaXMgbm8gc3VjaCBhbiBhbGJ1bSBpbiB0aGUgZGF0YWJhc2UnKTtcclxuICAgIH1cclxuICAgIH0pXHJcbiAgICBVc2VyLmZpbmRCeVRva2VuKHRva2VuKS50aGVuKCh1c2VyKSA9PntcclxuICAgICAgICBpZighdXNlcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIHdhcyBmb3VuZCcpO1xyXG4gICAgICAgIHZhciBsZW4gPXVzZXIubGlrZWRBbGJ1bXMubGVuZ3RoO1xyXG4gICAgICAgIGlmKGxlbiA9PSAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdXNlci5saWtlZEFsYnVtc1swXT1PYmplY3RJRChhbGJ1bUlkLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB1c2VyLm1hcmtNb2RpZmllZCgnbGlrZWRBbGJ1bXMnKVxyXG4gICAgICAgICAgICB1c2VyLnNhdmUoKTtcclxuICAgICAgICAgICAgYWxidW0uZmluZE9uZSh7X2lkOmFsYnVtSWR9KS50aGVuKChhbGJ1bSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYWxidW0ubGlrZXMgPSBhbGJ1bS5saWtlcyArMTtcclxuICAgICAgICAgICAgICAgIGFsYnVtLm1hcmtNb2RpZmllZCgnbGlrZXMnKTtcclxuICAgICAgICAgICAgICAgIGFsYnVtLnNhdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpPGxlbjtpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihhbGJ1bUlkPT11c2VyLmxpa2VkQWxidW1zW2ldKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoJ3lvdSBhcmUgdHJ5aW5nIHRvIGxpa2UgdGhlIHNhbWUgdHJhY2sgdHdpY2UnKTsgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB1c2VyLmxpa2VkQWxidW1zW2xlbl09T2JqZWN0SUQoYWxidW1JZC50b1N0cmluZygpKTtcclxuICAgICAgICB1c2VyLm1hcmtNb2RpZmllZCgnbGlrZWRUcmFja3MnKVxyXG4gICAgICAgIHVzZXIuc2F2ZSgpO1xyXG4gICAgICAgIGFsYnVtLmZpbmRPbmUoe19pZDphbGJ1bUlkfSkudGhlbigoYWxidW0pID0+IHtcclxuICAgICAgICAgICAgYWxidW0ubGlrZXMgPSBhbGJ1bS5saWtlcyArMTtcclxuICAgICAgICAgICAgYWxidW0ubWFya01vZGlmaWVkKCdsaWtlcycpO1xyXG4gICAgICAgICAgICBhbGJ1bS5zYXZlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoKTtcclxuICAgICAgICB9XHJcbiAgICB9KSBcclxufSk7XHJcblxyXG5cclxuLy8gaWYobW9kdWxlLnBhcmVudCl7XHJcbi8vICAgICBhcHAubGlzdGVuKDMwMDAsKCk9PntcclxuLy8gICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0ZWQgb24gcG9ydCAzMDAwXCIpO1xyXG4vLyAgICAgfSk7XHJcbi8vIH1cclxuXHJcbm1vZHVsZS5leHBvcnRzPSByb3V0ZXI7Il19